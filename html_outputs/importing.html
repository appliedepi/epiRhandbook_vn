<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>7 Nhập xuất dữ liệu | Cẩm nang dịch tễ học với R</title>

    <meta name="author" content="the handbook team" />
  
   <meta name="description" content="The Epi R Handbook is a R reference manual for applied epidemiology and public health." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="7 Nhập xuất dữ liệu | Cẩm nang dịch tễ học với R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The Epi R Handbook is a R reference manual for applied epidemiology and public health." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Nhập xuất dữ liệu | Cẩm nang dịch tễ học với R" />
  
  <meta name="twitter:description" content="The Epi R Handbook is a R reference manual for applied epidemiology and public health." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.6.1/transition.js"></script>
    <script src="libs/bs3compat-0.6.1/tabs.js"></script>
    <script src="libs/bs3compat-0.6.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.31/datatables.js"></script>
    <link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
    <link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
    <link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="libs/selectize-0.12.0/selectize.min.js"></script>
    <link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
    <script src="libs/tabwid-1.1.3/tabwid.js"></script>
    <link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-1.3.1/leaflet.js"></script>
    <link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4-2.6.2/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
    <script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
    <script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
    <script src="libs/viz-1.8.2/viz.js"></script>
    <link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding-1.0.11/grViz.js"></script>
    <script src="libs/d3-4.5.0/d3.min.js"></script>
    <script src="libs/sankey-1/sankey.js"></script>
    <script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
    <script src="libs/plotly-binding-4.10.4/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
    <link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
    <script src="libs/vis-9.1.0/vis-network.min.js"></script>
    <script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
    <link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script src="libs/plotly-basic-2.11.1/plotly-basic-2.11.1.min.js"></script>
    <script src="libs/plotly-cartesian-2.11.1/plotly-cartesian-2.11.1.min.js"></script>
    <script src="libs/proj4js-2.3.15/proj4.js"></script>
    <link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet" />
    <script src="libs/highcharts-9.3.1/highcharts.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-3d.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-more.js"></script>
    <script src="libs/highcharts-9.3.1/modules/stock.js"></script>
    <script src="libs/highcharts-9.3.1/modules/map.js"></script>
    <script src="libs/highcharts-9.3.1/modules/data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/drilldown.js"></script>
    <script src="libs/highcharts-9.3.1/modules/item-series.js"></script>
    <script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
    <script src="libs/highcharts-9.3.1/modules/annotations.js"></script>
    <script src="libs/highcharts-9.3.1/modules/export-data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/funnel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/heatmap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/treemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sankey.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/organization.js"></script>
    <script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
    <script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sunburst.js"></script>
    <script src="libs/highcharts-9.3.1/modules/vector.js"></script>
    <script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script>
    <script src="libs/highcharts-9.3.1/modules/xrange.js"></script>
    <script src="libs/highcharts-9.3.1/modules/tilemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/venn.js"></script>
    <script src="libs/highcharts-9.3.1/modules/gantt.js"></script>
    <script src="libs/highcharts-9.3.1/modules/timeline.js"></script>
    <script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
    <script src="libs/highcharts-9.3.1/modules/bullet.js"></script>
    <script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script>
    <script src="libs/highcharts-9.3.1/modules/lollipop.js"></script>
    <script src="libs/highcharts-9.3.1/modules/series-label.js"></script>
    <script src="libs/highcharts-9.3.1/plugins/motion.js"></script>
    <script src="libs/highcharts-9.3.1/custom/reset.js"></script>
    <script src="libs/highcharts-9.3.1/modules/boost.js"></script>
    <script src="libs/highchart-binding-0.9.4/highchart.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QXDW878QLX');
    </script>

    <div class="alert alert-info alert-dismissible">
      <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
      <strong>Bạn cần trợ giúp khi học R?</strong> Hãy tham gia <a href="https://www.appliedepi.org/live/" class="alert-link">khóa học</a>, trải nghiệm <a href="https://www.appliedepi.org/tutorial/" class="alert-link">các học phần miễn phí</a>, gửi bài viết <a href="https://community.appliedepi.org/" class="alert-link">trên trang Cộng đồng</a>, hoặc liên hệ <a href="mailto:contact@appliedepi.org" class="alert-link">dịch vụ hỗ trợ của chúng tôi</a>.
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style_bs4.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Cẩm nang dịch tễ học với R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="importing" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Nhập xuất dữ liệu</h1>
<p><img src="images/Import_Export_1500x500.png" width="100%" /></p>
<p>Trong chương này, chúng tôi mô tả các cách để định vị, nhập và xuất tệp:</p>
<ul>
<li><p>Sử dụng package <strong>rio</strong> để <code>import()</code> và <code>export()</code> linh hoạt nhiều loại tệp<br />
</p></li>
<li><p>Sử dụng package <strong>here</strong> để định vị tệp liên quan đến dự án R gốc - để ngăn ngừa sự phức tạp do nhiều đường dẫn tệp chỉ dành riêng cho một máy tính<br />
</p></li>
<li><p>Các tình huống nhập dữ liệu thường gặp:</p>
<ul>
<li>Từ một Trang tính Excel<br />
</li>
<li>Có tiêu đề sắp xếp lộn xộn và cần bỏ qua một số hàng<br />
</li>
<li>Từ trang tính của Google<br />
</li>
<li>Từ dữ liệu được đăng lên các trang web<br />
</li>
<li>Với APIs<br />
</li>
<li>Nhập tệp <em>gần đây nhất</em><br />
</li>
</ul></li>
<li><p>Nhập dữ liệu thủ công<br />
</p></li>
<li><p>Các loại tệp R đặc trưng ví dụ như RDS và RData<br />
</p></li>
<li><p>Xuất/lưu tệp và biểu đồ</p></li>
</ul>
<!-- ======================================================= -->
<div id="tổng-quan" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Tổng quan</h2>
<p>Khi bạn nhập một “dataset (bộ dữ liệu)” vào R, bạn thường cần tạo ra một đối tượng <em>data frame</em> mới trong môi trường R và định nghĩa nó là tệp được nhập (ví dụ: Excel, CSV, TSV, RDS), từ trong các thư mục của bạn tại một đường dẫn/địa chỉ tệp nhất định.</p>
<p>Bạn có thể nhập/xuất nhiều loại tệp, bao gồm cả những tệp được tạo bởi các chương trình thống kê khác (SAS, STATA, SPSS). Bạn cũng có thể kết nối với các cơ sở dữ liệu liên quan.</p>
<p>R thậm chí còn có các định dạng dữ liệu riêng:</p>
<ul>
<li>Một tệp RDS (.rds) lưu trữ một đối tượng R đơn lẻ, chẳng hạn như một data frame. Chúng hữu ích trong việc lưu trữ dữ liệu đã được làm sạch, vì chúng giữ lại kiểu dữ liệu cho các cột R. Đọc thêm trong <a href="importing.html#import_rds">mục này</a>.<br />
</li>
<li>Một tệp RData (.Rdata) có thể được sử dụng để lưu trữ nhiều đối tượng hoặc thậm chí là một không gian làm việc trong R hoàn chỉnh. Đọc thêm trong <a href="importing.html#import_rdata">mục này</a>.</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="package-rio" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Package <strong>rio</strong></h2>
<p>Package R chúng tôi gợi ý là: <strong>rio</strong>. Tên “rio” là chữ viết tắt của “R I/O” (dữ liệu đầu vào (input)/kết quả đầu ra (output)).</p>
<p>Hàm <code>import()</code> và <code>export()</code> có thể xử lý nhiều loại tệp khác nhau (ví dụ: .xlsx, .csv, .rds, .tsv). Khi bạn cung cấp đường dẫn tệp đến một trong các hàm này (bao gồm cả đuôi file mở rộng như “.csv”), <strong>rio</strong> sẽ đọc phần mở rộng và sử dụng đúng công cụ để nhập hoặc xuất tệp.</p>
<p>Giải pháp thay thế cho việc sử dụng <strong>rio</strong> là sử dụng các hàm từ nhiều package khác, mỗi package cụ thể cho một loại tệp. Ví dụ như, <code>read.csv()</code> (<strong>base</strong> R), <code>read.xlsx()</code> (package <strong>openxlsx</strong>) và <code>write_csv()</code> (package <strong>readr</strong>), v.v… Những lựa chọn thay thế này có thể khó nhớ, trong khi sử dụng <code>import()</code> và <code>export()</code> từ <strong>rio</strong> rất dễ dàng.</p>
<p>Các hàm <code>import()</code> và <code>export()</code> của <strong>rio</strong> sử dụng package và lệnh phù hợp cho một tệp nhất định, dựa trên phần mở rộng của tệp đó. Xem phần cuối của chương này để xem bảng đầy đủ về các package/hàm <strong>rio</strong> sử dụng trong nền. Hàm này cũng có thể được sử dụng để nhập các tệp STATA, SAS và SPSS trong hàng tá các loại tệp khác.</p>
<p>Nhập/xuất shapefiles đòi hỏi sử dụng các package khác, được mô tả cụ thể trong chương <a href="data-used.html#gis">GIS cơ bản</a>.</p>
</div>
<div id="here" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Package <strong>here</strong></h2>
<p>Package <strong>here</strong> và hàm <code>here()</code> của nó giúp R dễ dàng biết nơi tìm và lưu tệp của bạn - về bản chất, nó xây dựng đường dẫn tệp.</p>
<p>Được sử dụng cùng với dự án R, <strong>here</strong> cho phép bạn mô tả vị trí các tệp trong dự án R của bạn trong <em>thư mục gốc (root directory</em>) của dự án R (thư mục cấp cao nhất). Điều này hữu ích khi dự án R có thể được chia sẻ hoặc truy cập bởi nhiều người dùng/máy tính. Package này ngăn ngừa sự phức tạp do các đường dẫn tệp là duy nhất trên các máy tính khác nhau (ví dụ: <code>"C:/Users/Laura/Documents..."</code>) bằng cách “khởi động (starting)” đường dẫn tệp ở thư mục chung cho tất cả người dùng (dự án R gốc).</p>
<p>Đây là cách <code>here()</code> làm việc trong một dự án R:</p>
<ul>
<li>Khi package <strong>here</strong> được tải lần đầu tiên trong dự án R, nó đặt một tệp nhỏ có tên là “.here” trong thư mục gốc dự án R của bạn như là một “điểm chuẩn” hoặc “mỏ neo”<br />
</li>
<li>Trong script của bạn, để tham chiếu một tệp trong các thư mục con của dự án R, bạn sử dụng hàm <code>here()</code> để tạo đường dẫn tệp <em>liên quan đến thư mục gốc (anchor)</em></li>
<li>Để tạo đường dẫn tệp, viết tên các thư mục bên ngoài thư mục gốc, trong dấu ngoặc kép, được phân tách bằng dấu phẩy, cuối cùng kết thúc bằng tên và phần mở rộng của tệp như được trình bày dưới đây<br />
</li>
<li>Các đường dẫn tệp <code>here()</code> có thể được sử dụng cả để nhập và xuất dữ liệu</li>
</ul>
<p>Ví dụ, dưới đây, một đường dẫn tệp được tạo bởi hàm <code>here()</code> đang được cung cấp cho hàm <code>import()</code></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="importing.html#cb131-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;linelists&quot;</span>, <span class="st">&quot;ebola_linelist.xlsx&quot;</span>))</span></code></pre></div>
<p>Lệnh <code>here("data", "linelists", "ebola_linelist.xlsx")</code> trên thực tế đang cung cấp đường dẫn tệp đầy đủ mà <em>là duy nhất cho máy tính của người dùng:</em></p>
<pre><code>&quot;C:/Users/Laura/Documents/my_R_project/data/linelists/ebola_linelist.xlsx&quot;</code></pre>
<p>Ưu điểm là lệnh <code>here()</code> được R sử dụng có thể chạy thành công trên bất kỳ máy tính nào truy cập vào dự án R.</p>
<p><span style="color: darkgreen;"><strong><em>MẸO:</em></strong> Nếu bạn không chắc gốc “.here” được đặt ở đâu, hãy chạy lệnh <code>here()</code> với dấu ngoặc đơn trống.</span></p>
<p>Đọc thêm về package <strong>here</strong> <a href="https://here.r-lib.org/">tại đường dẫn này</a>.</p>
<!-- ======================================================= -->
</div>
<div id="đường-dẫn-tệp" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Đường dẫn tệp</h2>
<p>Khi nhập hoặc xuất dữ liệu, bạn phải cung cấp một đường dẫn tệp. Bạn có thể thực hiện thao tác này bằng một trong ba cách sau:</p>
<ol style="list-style-type: decimal">
<li><em>Khuyên dùng:</em> cung cấp một đường dẫn tệp “tương đối” bằng package <strong>here</strong><br />
</li>
<li>Cung cấp đường dẫn tệp “đầy đủ” / “tuyệt đối”<br />
</li>
<li>Chọn tệp theo cách thủ công</li>
</ol>
<div id="đường-dẫn-tệp-tương-đối" class="section level3 unnumbered">
<h3>Đường dẫn tệp “tương đối”</h3>
<p>Trong R, đường dẫn tệp “tương đối” bao gồm đường dẫn tệp mà <em>liên quan</em> đến phần gốc của dự án R. Chúng cho phép nhiều đường dẫn tệp đơn giản hơn có thể làm việc trên nhiều máy tính khác nhau (ví dụ: nếu dự án R nằm trên bộ nhớ dùng chung hoặc được gửi qua thư điện tử). Như đã được <a href="importing.html#here">mô tả ở trên</a>, đường dẫn tệp tương đối được tạo ra dễ dàng bằng cách sử dụng package <strong>here</strong>.</p>
<p>Dưới đây là một ví dụ về đường dẫn tệp tương đối được tạo bằng package <code>here()</code>. Chúng tôi giả sử công việc nằm trong một dự án R có chứa một thư mục con “data” và bên trong nó là thư mục con “linelists”, trong đó có tệp .xlsx được quan tâm.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="importing.html#cb133-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;linelists&quot;</span>, <span class="st">&quot;ebola_linelist.xlsx&quot;</span>))</span></code></pre></div>
</div>
<div id="đường-dẫn-tệp-tuyệt-đối" class="section level3 unnumbered">
<h3>Đường dẫn tệp “tuyệt đối”</h3>
<p>Đường dẫn tệp tuyệt đối hay “đầy đủ” có thể được cung cấp cho các hàm như <code>import()</code> nhưng chúng “dễ đứt gãy” bởi vì chúng là duy nhất đối với các máy tính của những người dùng khác nhau, và do đó <em>không được khuyến khích</em> sử dụng.</p>
<p>Dưới đây là một ví dụ về đường dẫn tệp tuyệt đối, trong máy tính của Laura có một thư mục “analysis”, tiếp theo là thư mục con “data” và bên trong là thư mục con “linelists”, trong đó có tệp .xlsx được quan tâm.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="importing.html#cb134-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;C:/Users/Laura/Documents/analysis/data/linelists/ebola_linelist.xlsx&quot;</span>)</span></code></pre></div>
<p>Một vài điều cần lưu ý về đường dẫn tệp tuyệt đối:</p>
<ul>
<li><strong>Tránh sử dụng đường dẫn tệp tuyệt đối</strong> vì chúng sẽ bị đứt gãy nếu script được chạy trên một máy tính khác</li>
<li>Sử dụng dấu gạch chéo <em>tiến</em> (<code>/</code>), như trong ví dụ trên (lưu ý: đây <em>KHÔNG</em> phải là kiểu mặc định đối với đường dẫn tệp trong Windows)<br />
</li>
<li>Đường dẫn tệp bắt đầu với hai dấu gạch chéo (ví dụ: “//…”) sẽ có khả năng <strong>không được R nhận ra</strong> và tạo ra lỗi. Hãy cân nhắc chuyển công việc của bạn sang ổ đĩa “có tên” hoặc “có chữ” bắt đầu bằng một chữ cái (ví dụ: “J:” hoặc “C:”). Xem chương về <a href="directories.html#directories">Tương tác với thư mục làm việc</a> để biết thêm chi tiết về vấn đề này.</li>
</ul>
<p>Một tình huống mà đường dẫn tệp tuyệt đối có thể thích hợp là khi bạn muốn nhập một tệp từ bộ nhớ dùng chung có cùng đường dẫn tệp đầy đủ cho tất cả người dùng.</p>
<p><span style="color: darkgreen;"><strong><em>MẸO:</em></strong> Để nhanh chóng chuyển đổi tất cả <code>\</code> thành <code>/</code>, hãy bôi đen đoạn code cần chuyển, sử dụng Ctrl + F (trong Windows) và tích vào tùy chọn “In selection”, sau đó sử dụng chức năng thay thế (replace) để chuyển đổi chúng.</span></p>
<!-- ======================================================= -->
</div>
<div id="chọn-tệp-theo-cách-thủ-công" class="section level3 unnumbered">
<h3>Chọn tệp theo cách thủ công</h3>
<p>Bạn có thể nhập dữ liệu theo cách thủ công thông qua một trong các phương pháp sau:</p>
<ol style="list-style-type: decimal">
<li>Từ cửa sổ Environment trong RStudio, nhấp vào “Import Dataset” và chọn loại dữ liệu</li>
<li>Nhấp vào File / Import Dataset / (chọn loại dữ liệu)<br />
</li>
<li>Để lựa chọn thủ công bằng code, hãy sử dụng lệnh <code>file.choose()</code> trong <em>base R</em> (để trống dấu ngoặc đơn) để kích hoạt sự xuất hiện của một <strong>cửa sổ pop-up</strong> cho phép người dùng chọn tệp theo cách thủ công từ máy tính của họ. Ví dụ:</li>
</ol>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="importing.html#cb135-1" tabindex="-1"></a><span class="co"># Manual selection of a file. When this command is run, a POP-UP window will appear. </span></span>
<span id="cb135-2"><a href="importing.html#cb135-2" tabindex="-1"></a><span class="co"># The file path selected will be supplied to the import() command.</span></span>
<span id="cb135-3"><a href="importing.html#cb135-3" tabindex="-1"></a></span>
<span id="cb135-4"><a href="importing.html#cb135-4" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">file.choose</span>())</span></code></pre></div>
<p><span style="color: darkgreen;"><strong><em>MẸO:</em></strong> <strong>Cửa sổ pop-up</strong> có thể xuất hiện SAU cửa sổ RStudio của bạn.</span></p>
</div>
</div>
<div id="nhập-dữ-liệu" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Nhập dữ liệu</h2>
<p>Sử dụng lệnh <code>import()</code> để nhập một bộ dữ liệu khá đơn giản. Chỉ cần cung cấp đường dẫn của tệp (bao gồm tên và phần mở rộng của tệp) trong dấu ngoặc kép. Nếu sử dụng hàm <code>here()</code> để xây dựng đường dẫn tệp, hãy làm theo hướng dẫn ở bên trên. Dưới đây là một vài ví dụ:</p>
<p>Nhập một tệp csv nằm trong “thư mục làm việc (working directory)” của bạn hoặc trong thư mục gốc của dự án R:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="importing.html#cb136-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;linelist_cleaned.csv&quot;</span>)</span></code></pre></div>
<p>Nhập sheet đầu tiên của Excel workbook, được đặt trong thư mục con “data” và “linelists” của dự án R (đường dẫn tệp được tạo bằng hàm <code>here()</code>):</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="importing.html#cb137-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;linelists&quot;</span>, <span class="st">&quot;linelist_cleaned.xlsx&quot;</span>))</span></code></pre></div>
<p>Nhập một data frame (một tệp .rds ) sử dụng đường dẫn tệp tuyệt đối:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="importing.html#cb138-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;C:/Users/Laura/Documents/tuberculosis/data/linelists/linelist_cleaned.rds&quot;</span>)</span></code></pre></div>
<div id="trang-tính-excel-cụ-thể" class="section level3 unnumbered">
<h3>Trang tính Excel cụ thể</h3>
<p>Theo mặc định, nếu bạn cung cấp một Excel workbook (.xlsx) để nhập bằng hàm <code>import()</code>, trang tính đầu tiên của workbook sẽ được nhập. Nếu bạn muốn nhập một <strong>trang tính</strong> cụ thể, hãy cụ thể tên trang tính vào đối số <code>which =</code>. Ví dụ:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="importing.html#cb139-1" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;my_excel_file.xlsx&quot;</span>, <span class="at">which =</span> <span class="st">&quot;Sheetname&quot;</span>)</span></code></pre></div>
<p>Nếu sử dụng hàm <code>here()</code> để cung cấp một đường dẫn tương đối đến hàm <code>import()</code>, bạn vẫn có thể chỉ ra một trang tính cụ thể bằng cách thêm đối số <code>which =</code> sau dấu đóng ngoặc của hàm <code>here()</code>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="importing.html#cb140-1" tabindex="-1"></a><span class="co"># Demonstration: importing a specific Excel sheet when using relative pathways with the &#39;here&#39; package</span></span>
<span id="cb140-2"><a href="importing.html#cb140-2" tabindex="-1"></a>linelist_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;linelist.xlsx&quot;</span>), <span class="at">which =</span> <span class="st">&quot;Sheet1&quot;</span>)<span class="st">`</span><span class="at">  </span></span></code></pre></div>
<p>Để <em>xuất</em> một data frame từ R sang một trang tính Excel và phần còn lại của Excel workbook không thay đổi, bạn sẽ phải nhập, chỉnh sửa và xuất với một package thay thế chuyên biệt cho mục đích này, chẳng hạn như <strong>openxlsx</strong>. Xem thêm thông tin trong chương về <a href="directories.html#directories">Tương tác với thư mục làm việc</a> hoặc <a href="https://ycphs.github.io/openxlsx/">tại trang github này</a>.</p>
<p>Nếu Excel workbook của bạn có phần mở rộng là .xlsb (định dạng nhị phân của Excel workbook) bạn có thể sẽ không nhập được bằng package <strong>rio</strong>. Hãy cân nhắc lưu lại tệp dưới dạng .xlsx hoặc sử dụng một package như <strong>readxlsb</strong>, là package được xây dựng cho <a href="https://cran.r-project.org/web/packages/readxlsb/vignettes/read-xlsb-workbook.html">kiểu tệp này</a>.</p>
<!-- ======================================================= -->
</div>
<div id="import_missing" class="section level3 unnumbered">
<h3>Giá trị missing</h3>
<p>Bạn có thể muốn xác định (các) giá trị nào trong bộ dữ liệu của mình nên được coi là missing. Như đã giải thích trong chương về <a href="missing-data.html#missing-data">Dữ liệu missing</a>, giá trị cho dữ liệu missing trong R là <code>NA</code>, nhưng có thể bộ dữ liệu bạn muốn nhập vào sử dụng giá trị 99, “Missing” hoặc chỉ là khoảng trống ký tự ““.</p>
<p>Sử dụng đối số <code>na =</code> để (nhập) <code>import()</code> và cung cấp (các) giá trị trong dấu ngoặc kép (ngay cả khi chúng là các số). Bạn có thể chỉ định nhiều giá trị bằng cách gộp chúng trong một vectơ, bằng cách sử dụng <code>c()</code> như được trình bày dưới đây.</p>
<p>Tại đây, giá trị “99” trong bộ dữ liệu đã nhập được coi là missing và được chuyển đổi thành <code>NA</code> trong R.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="importing.html#cb141-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;my_linelist.xlsx&quot;</span>), <span class="at">na =</span> <span class="st">&quot;99&quot;</span>)</span></code></pre></div>
<p>Còn ở đây, bất kỳ giá trị nào là “Missing”, “” (ô trống) hoặc ” ” (khoảng trắng) trong bộ dữ liệu đã nhập đều được chuyển đổi thành <code>NA</code> trong R.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="importing.html#cb142-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;my_linelist.csv&quot;</span>), <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;Missing&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="bỏ-qua-một-số-hàng" class="section level3 unnumbered">
<h3>Bỏ qua một số hàng</h3>
<p>Đôi khi, bạn có thể không muốn nhập một hàng dữ liệu. Bạn có thể thực hiện thao tác này với đối số <code>skip =</code> nếu sử dụng hàm <code>import()</code> từ package <strong>rio</strong> trên tệp .xlsx hoặc .csv. Cung cấp số hàng bạn muốn bỏ qua.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="importing.html#cb143-1" tabindex="-1"></a>linelist_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;linelist_raw.xlsx&quot;</span>, <span class="at">skip =</span> <span class="dv">1</span>)  <span class="co"># does not import header row</span></span></code></pre></div>
<p>Không may là hàm <code>skip =</code> chỉ chấp nhận một giá trị số nguyên, <em>không</em> chấp nhận một khoảng (ví dụ: “2:10” sẽ không hoạt động). Để bỏ qua việc nhập các hàng cụ thể không liên tiếp từ trên cùng, hãy cân nhắc nhập nhiều lần và sử dụng hàm <code>bind_rows()</code> từ <strong>dplyr</strong>. Hãy xem ví dụ dưới đây về việc chỉ bỏ qua hàng thứ 2.</p>
</div>
<div id="quản-lý-hàng-tiêu-đề-thứ-hai" class="section level3 unnumbered">
<h3>Quản lý hàng tiêu đề thứ hai</h3>
<p>Đôi khi, dữ liệu của bạn có thể có hàng <em>thứ hai</em>, với chức năng như là “từ điển dữ liệu” như hình dưới đây. Trường hợp này có thể xảy ra vấn đề vì nó có thể dẫn đến việc tất cả các cột được nhập vào dưới dạng kiểu “ký tự (character)”.</p>
<p>Dưới đây là một ví dụ về kiểu bộ dữ liệu này (với hàng đầu tiên là từ điển dữ liệu).</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-f240101530bcf26e0d79" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f240101530bcf26e0d79">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["case identification number assigned by MOH","5fe599","8689b7","11f8ea","b8812a"],["transmission chain generation number","4","4","2","3"],["estimated date of infection, mm/dd/yyyy","2014-05-08",null,null,"2014-05-04"],["date of symptom onset, YYYY-MM-DD","2014-05-13","2014-05-13","2014-05-16","2014-05-18"],["date of initial hospitalization, mm/dd/yyyy","2014-05-15","2014-05-14","2014-05-18","2014-05-20"],["date of outcome status determination",null,"2014-05-18","2014-05-30",null],["either 'Death' or 'Recovered' or 'Unknown'",null,"Recover","Recover",null],["either 'm' or 'f' or 'unknown'","m","f","m","f"],["age number","2","3","56","18"],["age unit, either 'years' or 'months' or 'days'","years","years","years","years"],[null,"2","3","56","18"],[null,"0-4","0-4","50-69","15-19"],[null,"0-4","0-4","55-59","15-19"],["Name of hospital of first admission","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital"],["longitude of residence, approx","-13.2157351064963","-13.2152339775486","-13.212910703914","-13.2363711169728"],["latitude of residence, approx","8.46897295100924","8.45171855856465","8.46481700596819","8.4754761613651"],["case_id of infector","f547d6",null,null,"f90f5f"],["context of known transmission event","other",null,null,"other"],[null,"27","25","91","41"],[null,"48","59","238","135"],[null,"22","22","21","23"],["presence of fever on admission, either 'yes' or 'no'","no",null,null,"no"],["presence of chills on admission, either 'yes' or 'no'","no",null,null,"no"],["presence of cough on admission, either 'yes' or 'no'","yes",null,null,"no"],["presence of aches on admission, either 'yes' or 'no'","no",null,null,"no"],["presence of vomiting on admission, either 'yes' or 'no'","yes",null,null,"no"],[null,"36.8","36.9","36.9","36.8"],["time of hospital admission HH:MM",null,"09:36","16:48","11:22"],[null,"117.1875","71.8184429761563","16.0652496292635","22.4965706447188"],[null,"2","1","2","2"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"scrollX":true,"columnDefs":[{"name":"case_id","targets":0},{"name":"generation","targets":1},{"name":"date_infection","targets":2},{"name":"date_onset","targets":3},{"name":"date_hospitalisation","targets":4},{"name":"date_outcome","targets":5},{"name":"outcome","targets":6},{"name":"gender","targets":7},{"name":"age","targets":8},{"name":"age_unit","targets":9},{"name":"age_years","targets":10},{"name":"age_cat","targets":11},{"name":"age_cat5","targets":12},{"name":"hospital","targets":13},{"name":"lon","targets":14},{"name":"lat","targets":15},{"name":"infector","targets":16},{"name":"source","targets":17},{"name":"wt_kg","targets":18},{"name":"ht_cm","targets":19},{"name":"ct_blood","targets":20},{"name":"fever","targets":21},{"name":"chills","targets":22},{"name":"cough","targets":23},{"name":"aches","targets":24},{"name":"vomit","targets":25},{"name":"temp","targets":26},{"name":"time_admission","targets":27},{"name":"bmi","targets":28},{"name":"days_onset_hosp","targets":29}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[4,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="xóa-hàng-tiêu-đề-thứ-hai" class="section level3 unnumbered">
<h3>Xóa hàng tiêu đề thứ hai</h3>
<p>Để bỏ hàng tiêu đề thứ hai, bạn có thể sẽ cần nhập dữ liệu hai lần.</p>
<ol style="list-style-type: decimal">
<li>Nhập dữ liệu vào để lấy tên các cột chính xác<br />
</li>
<li>Nhập lại dữ liệu, bỏ qua <em>hai</em> hàng đầu tiên (hàng tiêu đề và hàng thứ hai)<br />
</li>
<li>Liên kết dataframe đã xóa bỏ 2 hàng đầu tiên với tên cột chính xác ở bước 1</li>
</ol>
<p>Đối số chính xác được sử dụng để liên kết các tên cột tùy thuộc vào loại tệp dữ liệu (.csv, .tsv, .xlsx, v.v.). Điều này là do <strong>rio</strong> sử dụng các hàm khác nhau cho các loại tệp khác nhau (xem bảng ở trên).</p>
<p><strong>Đối với tệp Excel:</strong> (<code>col_names =</code>)</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="importing.html#cb144-1" tabindex="-1"></a><span class="co"># import first time; store the column names</span></span>
<span id="cb144-2"><a href="importing.html#cb144-2" tabindex="-1"></a>linelist_raw_names <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;linelist_raw.xlsx&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">names</span>()  <span class="co"># save true column names</span></span>
<span id="cb144-3"><a href="importing.html#cb144-3" tabindex="-1"></a></span>
<span id="cb144-4"><a href="importing.html#cb144-4" tabindex="-1"></a><span class="co"># import second time; skip row 2, and assign column names to argument col_names =</span></span>
<span id="cb144-5"><a href="importing.html#cb144-5" tabindex="-1"></a>linelist_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;linelist_raw.xlsx&quot;</span>,</span>
<span id="cb144-6"><a href="importing.html#cb144-6" tabindex="-1"></a>                       <span class="at">skip =</span> <span class="dv">2</span>,</span>
<span id="cb144-7"><a href="importing.html#cb144-7" tabindex="-1"></a>                       <span class="at">col_names =</span> linelist_raw_names</span>
<span id="cb144-8"><a href="importing.html#cb144-8" tabindex="-1"></a>                       ) </span></code></pre></div>
<p><strong>Đối với tệp CSV:</strong> (<code>col.names =</code>)</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="importing.html#cb145-1" tabindex="-1"></a><span class="co"># import first time; sotre column names</span></span>
<span id="cb145-2"><a href="importing.html#cb145-2" tabindex="-1"></a>linelist_raw_names <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;linelist_raw.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">names</span>() <span class="co"># save true column names</span></span>
<span id="cb145-3"><a href="importing.html#cb145-3" tabindex="-1"></a></span>
<span id="cb145-4"><a href="importing.html#cb145-4" tabindex="-1"></a><span class="co"># note argument for csv files is &#39;col.names = &#39;</span></span>
<span id="cb145-5"><a href="importing.html#cb145-5" tabindex="-1"></a>linelist_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;linelist_raw.csv&quot;</span>,</span>
<span id="cb145-6"><a href="importing.html#cb145-6" tabindex="-1"></a>                       <span class="at">skip =</span> <span class="dv">2</span>,</span>
<span id="cb145-7"><a href="importing.html#cb145-7" tabindex="-1"></a>                       <span class="at">col.names =</span> linelist_raw_names</span>
<span id="cb145-8"><a href="importing.html#cb145-8" tabindex="-1"></a>                       ) </span></code></pre></div>
<p><strong>Tùy chọn sao lưu</strong> - thay đổi tên cột dưới dạng một lệnh riêng biệt</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="importing.html#cb146-1" tabindex="-1"></a><span class="co"># assign/overwrite headers using the base &#39;colnames()&#39; function</span></span>
<span id="cb146-2"><a href="importing.html#cb146-2" tabindex="-1"></a><span class="fu">colnames</span>(linelist_raw) <span class="ot">&lt;-</span> linelist_raw_names</span></code></pre></div>
<div id="tạo-từ-điển-dữ-liệu" class="section level4 unnumbered">
<h4>Tạo từ điển dữ liệu</h4>
<p>Thông tin thêm! Nếu bạn có hàng thứ hai là từ điển dữ liệu, bạn có thể dễ dàng tạo từ điển dữ liệu thích hợp từ nó. Mẹo này được tham khảo từ <a href="https://alison.rbind.io/post/2018-02-23-read-multiple-header-rows/">bài đăng</a> này.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="importing.html#cb147-1" tabindex="-1"></a>dict <span class="ot">&lt;-</span> linelist_2headers <span class="sc">%&gt;%</span>             <span class="co"># begin: linelist with dictionary as first row</span></span>
<span id="cb147-2"><a href="importing.html#cb147-2" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span>                             <span class="co"># keep only column names and first dictionary row                </span></span>
<span id="cb147-3"><a href="importing.html#cb147-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),       <span class="co"># pivot all columns to long format</span></span>
<span id="cb147-4"><a href="importing.html#cb147-4" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Column&quot;</span>,       <span class="co"># assign new column names</span></span>
<span id="cb147-5"><a href="importing.html#cb147-5" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Description&quot;</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2141d29c277f20500de5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2141d29c277f20500de5">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["case_id","generation","date_infection","date_onset","date_hospitalisation","date_outcome","outcome","gender","age","age_unit","age_years","age_cat","age_cat5","hospital","lon","lat","infector","source","wt_kg","ht_cm","ct_blood","fever","chills","cough","aches","vomit","temp","time_admission","bmi","days_onset_hosp"],["case identification number assigned by MOH","transmission chain generation number","estimated date of infection, mm/dd/yyyy","date of symptom onset, YYYY-MM-DD","date of initial hospitalization, mm/dd/yyyy","date of outcome status determination","either 'Death' or 'Recovered' or 'Unknown'","either 'm' or 'f' or 'unknown'","age number","age unit, either 'years' or 'months' or 'days'",null,null,null,"Name of hospital of first admission","longitude of residence, approx","latitude of residence, approx","case_id of infector","context of known transmission event",null,null,null,"presence of fever on admission, either 'yes' or 'no'","presence of chills on admission, either 'yes' or 'no'","presence of cough on admission, either 'yes' or 'no'","presence of aches on admission, either 'yes' or 'no'","presence of vomiting on admission, either 'yes' or 'no'",null,"time of hospital admission HH:MM",null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Column<\/th>\n      <th>Description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"scrollX":true,"columnDefs":[{"name":"Column","targets":0},{"name":"Description","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[4,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="kết-hợp-hai-hàng-tiêu-đề" class="section level4 unnumbered">
<h4>Kết hợp hai hàng tiêu đề</h4>
<p>Trong một số trường hợp khi bộ dữ liệu thô của bạn có <em>hai</em> hàng tiêu đề (hoặc cụ thể hơn, hàng dữ liệu thứ 2 là tiêu đề phụ), bạn có thể sẽ muốn “kết hợp” chúng hoặc thêm các giá trị trong hàng tiêu đề thứ hai vào hàng tiêu đề đầu tiên.</p>
<p>Lệnh dưới đây sẽ xác định tên cột của data frame là sự kết hợp (dán với nhau) của các tiêu đề (đúng) đầu tiên với giá trị ngay bên dưới (trong hàng đầu tiên).</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="importing.html#cb148-1" tabindex="-1"></a><span class="fu">names</span>(my_data) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(my_data), my_data[<span class="dv">1</span>, ], <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="trang-tính-google" class="section level3 unnumbered">
<h3>Trang tính Google</h3>
<p>Bạn có thể nhập dữ liệu từ một trang tính Google trực tuyến với package <strong>googlesheet4</strong> và bằng cách xác thực quyền truy cập của bạn vào trang tính.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="importing.html#cb149-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">&quot;googlesheets4&quot;</span>)</span></code></pre></div>
<p>Dưới đây là một trang tính Google minh họa được nhập và lưu. Lệnh này có thể yêu cầu xác thực tài khoản Google của bạn. Làm theo lời nhắc và cửa sổ bật lên trong trình duyệt Internet của bạn để cấp cho các package Tidyverse API quyền chỉnh sửa, tạo và xóa trang tính của bạn trong Google Drive.</p>
<p>Trang tính dưới đây “có thể được xem bởi bất kỳ ai có liên kết” và bạn có thể thử nhập trang tính đó.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="importing.html#cb150-1" tabindex="-1"></a>Gsheets_demo <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(<span class="st">&quot;https://docs.google.com/spreadsheets/d/1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY/edit#gid=0&quot;</span>)</span></code></pre></div>
<p>Trang tính cũng có thể được nhập chỉ bằng ID của sheet, một phần ngắn hơn của URL:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="importing.html#cb151-1" tabindex="-1"></a>Gsheets_demo <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(<span class="st">&quot;1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY&quot;</span>)</span></code></pre></div>
<p>Một package khác, <strong>googledrive</strong> cung cấp các hàm hữu ích để viết, chỉnh sửa và xóa các trang tính Google. Ví dụ: các hàm được sử dụng <code>gs4_create()</code> và <code>sheet_write()</code> đều được tìm thấy trong package này.</p>
<p>Dưới đây là một số hướng dẫn trực tuyến hữu ích khác:<br />
<a href="https://arbor-analytics.com/post/getting-your-data-into-r-from-google-sheets/">hướng dẫn nhập Google sheet cơ bản</a><br />
<a href="https://googlesheets4.tidyverse.org/articles/googlesheets4.html">hướng dẫn chi tiết hơn</a><br />
<a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">tương tác giữa googlesheets4 và tidyverse</a></p>
</div>
</div>
<div id="nhập-xuất-tách-kết-hợp---nhiều-tệp" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Nhập, xuất, tách, kết hợp - nhiều tệp</h2>
<p>Xem chương về <a href="iteration.html#iteration">Lặp, vòng lặp, và danh sách</a> để biết ví dụ về cách nhập và kết hợp nhiều tệp hoặc nhiều Excel workbook. Chương này cũng có các ví dụ về cách chia một data frame thành các phần và xuất từng phần riêng biệt hoặc dưới dạng các trang tính được đặt tên trong một Excel workbook.</p>
<!-- ======================================================= -->
</div>
<div id="import_github" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Nhập từ Github</h2>
<p>Nhập dữ liệu trực tiếp từ Github vào R có thể rất dễ dàng hoặc có thể yêu cầu một vài bước - tùy thuộc vào loại tệp. Dưới đây là một số cách tiếp cận:</p>
<div id="tệp-csv" class="section level3 unnumbered">
<h3>Tệp CSV</h3>
<p>Có thể dễ dàng nhập tệp .csv trực tiếp từ Github vào R bằng lệnh R.</p>
<ol style="list-style-type: decimal">
<li>Đi tới repo Github, tìm tệp quan tâm và nhấp vào tệp đó<br />
</li>
<li>Nhấp vào nút “Raw” (sau đó bạn sẽ thấy dữ liệu csv “thô”, như được hiển thị bên dưới)<br />
</li>
<li>Sao chép URL (địa chỉ web)<br />
</li>
<li>Đặt URL trong dấu ngoặc kép trong lệnh R <code>import()</code></li>
</ol>
<p><img src="images/download_csv_raw.png" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="tệp-xlsx" class="section level3 unnumbered">
<h3>Tệp XLSX</h3>
<p>Bạn có thể không xem được dữ liệu “Thô” cho một số tệp (ví dụ: .xlsx, .rds, .nwk, .shp)</p>
<ol style="list-style-type: decimal">
<li>Đi tới repo Github, tìm tệp quan tâm và nhấp vào tệp đó<br />
</li>
<li>Nhấp vào nút “Download”, như được hiển thị bên dưới<br />
</li>
<li>Lưu tệp trên máy tính của bạn và nhập tệp đó vào R</li>
</ol>
<p><img src="images/download_xlsx.png" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="shapefiles" class="section level3 unnumbered">
<h3>Shapefiles</h3>
<p>Các Shapefiles có nhiều tệp thành phần phụ, mỗi tệp có một phần mở rộng khác nhau. Một tệp sẽ có phần mở rộng “.shp”, nhưng những tệp khác có thể là “.dbf”, “.prj”, v.v. Để tải xuống shapefiles từ Github, bạn sẽ cần tải xuống từng tệp thành phần phụ riêng lẻ và lưu chúng trong cùng một thư mục trên máy tính của bạn. Trong Github, nhấp vào từng tệp riêng lẻ và tải chúng xuống bằng cách nhấp vào nút “Download”.</p>
<p>Một khi được lưu vào máy tính, bạn có thể nhập định dạng tệp như được trình bày trong chương <a href="data-used.html#gis">GIS cơ bản</a> bằng cách sử dụng hàm <code>st_read()</code> từ package <strong>sf</strong>. Bạn chỉ cần cung cấp đường dẫn tệp và tên của tệp “.shp” - miễn là các tệp liên quan khác nằm trong cùng một thư mục trên máy tính của bạn.</p>
<p>Dưới đây, bạn có thể thấy shapefiles tên “sl_adm3” bao gồm nhiều tệp như thế nào - mỗi tệp phải được tải xuống từ Github.</p>
<p><img src="images/download_shp.png" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
<!-- ======================================================= -->
</div>
</div>
<div id="nhập-dữ-liệu-thủ-công" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Nhập dữ liệu thủ công</h2>
<div id="nhập-theo-hàng" class="section level3 unnumbered">
<h3>Nhập theo hàng</h3>
<p>Sử dụng hàm <code>tribble</code> của package <strong>tibble</strong> từ tidyverse (<a href="https://tibble.tidyverse.org/reference/tribble.html">tài liệu tham khảo trực tuyến</a>).</p>
<p>Lưu ý cách tiêu đề cột bắt đầu bằng dấu ngã (<code>~</code>). Cũng lưu ý rằng mỗi cột chỉ được chứa một nhóm dữ liệu (ký tự, số, v.v.). Bạn có thể sử dụng các tab, khoảng cách và hàng mới để làm cho việc nhập dữ liệu trực quan và dễ đọc hơn. Khoảng trắng không quan trọng giữa các giá trị, nhưng mỗi hàng được biểu thị bằng một dòng code mới. Ví dụ:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="importing.html#cb152-1" tabindex="-1"></a><span class="co"># create the dataset manually by row</span></span>
<span id="cb152-2"><a href="importing.html#cb152-2" tabindex="-1"></a>manual_entry_rows <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb152-3"><a href="importing.html#cb152-3" tabindex="-1"></a>  <span class="sc">~</span>colA, <span class="sc">~</span>colB,</span>
<span id="cb152-4"><a href="importing.html#cb152-4" tabindex="-1"></a>  <span class="st">&quot;a&quot;</span>,   <span class="dv">1</span>,</span>
<span id="cb152-5"><a href="importing.html#cb152-5" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span>,   <span class="dv">2</span>,</span>
<span id="cb152-6"><a href="importing.html#cb152-6" tabindex="-1"></a>  <span class="st">&quot;c&quot;</span>,   <span class="dv">3</span></span>
<span id="cb152-7"><a href="importing.html#cb152-7" tabindex="-1"></a>  )</span></code></pre></div>
<p>Và giờ chúng ta hiển thị bộ dữ liệu mới:</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1d95b08e9d8f2354c370" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1d95b08e9d8f2354c370">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["a","b","c"],[1,2,3]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>colA<\/th>\n      <th>colB<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"colA","targets":1},{"name":"colB","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="nhập-theo-cột" class="section level3 unnumbered">
<h3>Nhập theo cột</h3>
<p>Vì data frame bao gồm các vectơ (cột dọc), cách tiếp cận <strong>cơ bản</strong> để tạo data frame thủ công trong R yêu cầu bạn phải tạo từng cột và sau đó liên kết chúng lại với nhau. Điều này có thể phản trực quan trong dịch tễ học, vì chúng ta thường nghĩ về dữ liệu của mình theo hàng (như trên).</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="importing.html#cb153-1" tabindex="-1"></a><span class="co"># define each vector (vertical column) separately, each with its own name</span></span>
<span id="cb153-2"><a href="importing.html#cb153-2" tabindex="-1"></a>PatientID <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">235</span>, <span class="dv">452</span>, <span class="dv">778</span>, <span class="dv">111</span>)</span>
<span id="cb153-3"><a href="importing.html#cb153-3" tabindex="-1"></a>Treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>)</span>
<span id="cb153-4"><a href="importing.html#cb153-4" tabindex="-1"></a>Death     <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><span style="color: orange;"><strong><em>CHÚ Ý:</em></strong> Tất cả các vectơ phải có cùng độ dài (cùng số giá trị).</span></p>
<p>Các vectơ sau đó có thể được liên kết với nhau bằng cách sử dụng lệnh <code>data.frame()</code>:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="importing.html#cb154-1" tabindex="-1"></a><span class="co"># combine the columns into a data frame, by referencing the vector names</span></span>
<span id="cb154-2"><a href="importing.html#cb154-2" tabindex="-1"></a>manual_entry_cols <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(PatientID, Treatment, Death)</span></code></pre></div>
<p>Và giờ chúng ta hiển thị bộ dữ liệu mới:</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-82168cee983e19bd132d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-82168cee983e19bd132d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],[235,452,778,111],["Yes","No","Yes","Yes"],[1,0,1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>PatientID<\/th>\n      <th>Treatment<\/th>\n      <th>Death<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"PatientID","targets":1},{"name":"Treatment","targets":2},{"name":"Death","targets":3}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dán-từ-clipboard" class="section level3 unnumbered">
<h3>Dán từ clipboard</h3>
<p>Nếu bạn sao chép dữ liệu từ nơi khác và có nó trong clipboard (bộ nhớ tạm), bạn có thể thử một trong hai cách dưới đây:</p>
<p>Từ package <strong>clipr</strong>, bạn có thể sử dụng hàm <code>read_clip_tbl()</code> để nhập dưới dạng data frame hoặc chỉ cần hàm <code>read_clip()</code> để nhập dưới dạng một vectơ ký tự. Trong cả hai trường hợp, hãy để trống dấu ngoặc đơn.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="importing.html#cb155-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> clipr<span class="sc">::</span><span class="fu">read_clip_tbl</span>()  <span class="co"># imports current clipboard as data frame</span></span>
<span id="cb155-2"><a href="importing.html#cb155-2" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> clipr<span class="sc">::</span><span class="fu">read_clip</span>()      <span class="co"># imports as character vector</span></span></code></pre></div>
<p>Bạn cũng có thể dễ dàng xuất sang clipboard của hệ thống bằng <strong>clipr</strong>. Xem mục bên dưới về Xuất dữ liệu.</p>
<p>Ngoài ra, bạn có thể sử dụng lệnh <code>read.table()</code> từ <strong>base</strong> R với <code>file = "clipboard")</code> để nhập dưới dạng data frame:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="importing.html#cb156-1" tabindex="-1"></a>df_from_clipboard <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb156-2"><a href="importing.html#cb156-2" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;clipboard&quot;</span>,  <span class="co"># specify this as &quot;clipboard&quot;</span></span>
<span id="cb156-3"><a href="importing.html#cb156-3" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;t&quot;</span>,           <span class="co"># separator could be tab, or commas, etc.</span></span>
<span id="cb156-4"><a href="importing.html#cb156-4" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>)         <span class="co"># if there is a header row</span></span></code></pre></div>
</div>
</div>
<div id="nhập-tệp-gần-đây-nhất" class="section level2" number="7.9">
<h2><span class="header-section-number">7.9</span> Nhập tệp gần đây nhất</h2>
<p>Thường thì bạn có thể nhận được các bản cập nhật hàng ngày cho bộ dữ liệu của mình. Trong trường hợp này, bạn sẽ muốn viết code mà nhập tệp gần đây nhất. Dưới đây, chúng tôi trình bày hai cách để tiếp cận điều này:</p>
<ul>
<li>Chọn tệp dựa trên ngày trong tên tệp<br />
</li>
<li>Chọn tệp dựa trên metadata (siêu dữ liệu - là dạng dữ liệu mô tả thông tin chi tiết về dữ liệu) của tệp (lần sửa đổi cuối cùng)</li>
</ul>
<div id="ngày-trong-tên-tệp" class="section level3 unnumbered">
<h3>Ngày trong tên tệp</h3>
<p>Cách tiếp cận này dựa trên ba cơ sở:</p>
<ol style="list-style-type: decimal">
<li>Bạn tin tưởng ngày tháng trong tên tệp<br />
</li>
<li>Ngày tháng ở dạng số và <em>thường</em> xuất hiện ở cùng một định dạng (ví dụ: năm rồi tháng rồi ngày)<br />
</li>
<li>Không có số nào khác trong tên tệp</li>
</ol>
<p>Chúng tôi sẽ giải thích từng bước và sau đó cho bạn thấy cách chúng được kết hợp ở phần cuối.</p>
<p>Đầu tiên, sử dụng <code>dir()</code> từ <strong>base</strong> R để chỉ trích xuất tên tệp cho mỗi tệp trong thư mục quan tâm. Xem chương về <a href="directories.html#directories">Tương tác với thư mục làm việc</a> để biết thêm chi tiết về <code>dir()</code>. Trong ví dụ này, thư mục quan tâm là thư mục “linelists” trong thư mục “example” chứa trong thư mục “data” của dự án R.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="importing.html#cb157-1" tabindex="-1"></a>linelist_filenames <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;example&quot;</span>, <span class="st">&quot;linelists&quot;</span>)) <span class="co"># get file names from folder</span></span>
<span id="cb157-2"><a href="importing.html#cb157-2" tabindex="-1"></a>linelist_filenames                                              <span class="co"># print</span></span></code></pre></div>
<pre><code>## [1] &quot;20201007linelist.csv&quot;          &quot;case_linelist_2020-10-02.csv&quot; 
## [3] &quot;case_linelist_2020-10-03.csv&quot;  &quot;case_linelist_2020-10-04.csv&quot; 
## [5] &quot;case_linelist_2020-10-05.csv&quot;  &quot;case_linelist_2020-10-08.xlsx&quot;
## [7] &quot;case_linelist20201006.csv&quot;</code></pre>
<p>Một khi bạn có vectơ chứa các tên này, bạn có thể trích xuất ngày với chúng bằng cách áp dụng hàm <code>str_extract()</code> từ <strong>stringr</strong> với việc sử dụng biểu thức chính quy sau đây. Nó giúp trích xuất bất kỳ số nào trong tên tệp (bao gồm bất kỳ ký tự nào khác ở giữa như dấu gạch ngang hoặc dấu gạch chéo). Bạn có thể đọc thêm về <strong>stringr</strong> trong chương <a href="characters-strings.html#characters-strings">Ký tự và chuỗi</a>.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="importing.html#cb159-1" tabindex="-1"></a>linelist_dates_raw <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(linelist_filenames, <span class="st">&quot;[0-9].*[0-9]&quot;</span>) <span class="co"># extract numbers and any characters in between</span></span>
<span id="cb159-2"><a href="importing.html#cb159-2" tabindex="-1"></a>linelist_dates_raw  <span class="co"># print</span></span></code></pre></div>
<pre><code>## [1] &quot;20201007&quot;   &quot;2020-10-02&quot; &quot;2020-10-03&quot; &quot;2020-10-04&quot; &quot;2020-10-05&quot; &quot;2020-10-08&quot;
## [7] &quot;20201006&quot;</code></pre>
<p>Giả sử ngày thường được viết theo cùng một định dạng ngày (ví dụ: Năm rồi Tháng rồi Ngày) và năm có 4 chữ số, bạn có thể sử dụng các hàm chuyển đổi linh hoạt của <strong>lubridate</strong> (<code>ymd()</code>, <code>dmy()</code>, or <code>mdy()</code>) để chuyển đổi chúng thành ngày. Đối với các hàm này, dấu gạch ngang, dấu cách hoặc dấu gạch chéo không quan trọng, quan trọng chỉ là thứ tự của các số. Đọc thêm trong chương <a href="dates.html#dates">Làm việc với ngày tháng</a>.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="importing.html#cb161-1" tabindex="-1"></a>linelist_dates_clean <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(linelist_dates_raw)</span>
<span id="cb161-2"><a href="importing.html#cb161-2" tabindex="-1"></a>linelist_dates_clean</span></code></pre></div>
<pre><code>## [1] &quot;2020-10-07&quot; &quot;2020-10-02&quot; &quot;2020-10-03&quot; &quot;2020-10-04&quot; &quot;2020-10-05&quot; &quot;2020-10-08&quot;
## [7] &quot;2020-10-06&quot;</code></pre>
<p>Sau đó, hàm <strong>base</strong> R <code>which.max()</code> có thể được sử dụng để trả về vị trí chỉ mục (ví dụ: 1, 2, 3,…) của giá trị ngày lớn nhất. Tệp mới nhất được xác định chính xác là tệp thứ 6 - “case_linelist_2020-10-08.xlsx”.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="importing.html#cb163-1" tabindex="-1"></a>index_latest_file <span class="ot">&lt;-</span> <span class="fu">which.max</span>(linelist_dates_clean)</span>
<span id="cb163-2"><a href="importing.html#cb163-2" tabindex="-1"></a>index_latest_file</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>Nếu chúng ta tổng hợp tất cả các lệnh này, code hoàn chỉnh có thể trông giống như bên dưới. Lưu ý rằng dấu <code>.</code> ở dòng cuối cùng thay thế cho đối tượng được truyền vào hàm trước đó. Tại thời điểm đó, giá trị chỉ đơn giản là số 6. Giá trị này được đặt trong dấu ngoặc kép để trích xuất phần tử thứ 6 của vectơ tên tệp được tạo bởi <code>dir()</code>.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="importing.html#cb165-1" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb165-2"><a href="importing.html#cb165-2" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb165-3"><a href="importing.html#cb165-3" tabindex="-1"></a>  tidyverse,         <span class="co"># data management</span></span>
<span id="cb165-4"><a href="importing.html#cb165-4" tabindex="-1"></a>  stringr,           <span class="co"># work with strings/characters</span></span>
<span id="cb165-5"><a href="importing.html#cb165-5" tabindex="-1"></a>  lubridate,         <span class="co"># work with dates</span></span>
<span id="cb165-6"><a href="importing.html#cb165-6" tabindex="-1"></a>  rio,               <span class="co"># import / export</span></span>
<span id="cb165-7"><a href="importing.html#cb165-7" tabindex="-1"></a>  here,              <span class="co"># relative file paths</span></span>
<span id="cb165-8"><a href="importing.html#cb165-8" tabindex="-1"></a>  fs)                <span class="co"># directory interactions</span></span>
<span id="cb165-9"><a href="importing.html#cb165-9" tabindex="-1"></a></span>
<span id="cb165-10"><a href="importing.html#cb165-10" tabindex="-1"></a><span class="co"># extract the file name of latest file</span></span>
<span id="cb165-11"><a href="importing.html#cb165-11" tabindex="-1"></a>latest_file <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;example&quot;</span>, <span class="st">&quot;linelists&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># file names from &quot;linelists&quot; sub-folder          </span></span>
<span id="cb165-12"><a href="importing.html#cb165-12" tabindex="-1"></a>  <span class="fu">str_extract</span>(<span class="st">&quot;[0-9].*[0-9]&quot;</span>) <span class="sc">%&gt;%</span>                  <span class="co"># pull out dates (numbers)</span></span>
<span id="cb165-13"><a href="importing.html#cb165-13" tabindex="-1"></a>  <span class="fu">ymd</span>() <span class="sc">%&gt;%</span>                                        <span class="co"># convert numbers to dates (assuming year-month-day format)</span></span>
<span id="cb165-14"><a href="importing.html#cb165-14" tabindex="-1"></a>  <span class="fu">which.max</span>() <span class="sc">%&gt;%</span>                                  <span class="co"># get index of max date (latest file)</span></span>
<span id="cb165-15"><a href="importing.html#cb165-15" tabindex="-1"></a>  <span class="fu">dir</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;example&quot;</span>, <span class="st">&quot;linelists&quot;</span>))[[.]]              <span class="co"># return the filename of latest linelist</span></span>
<span id="cb165-16"><a href="importing.html#cb165-16" tabindex="-1"></a></span>
<span id="cb165-17"><a href="importing.html#cb165-17" tabindex="-1"></a>latest_file  <span class="co"># print name of latest file</span></span></code></pre></div>
<pre><code>## [1] &quot;case_linelist_2020-10-08.xlsx&quot;</code></pre>
<p>Bây giờ bạn có thể sử dụng tên này để hoàn thiện đường dẫn tệp tương đối, với hàm <code>here()</code>:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="importing.html#cb167-1" tabindex="-1"></a><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;example&quot;</span>, <span class="st">&quot;linelists&quot;</span>, latest_file) </span></code></pre></div>
<p>Và bây giờ bạn có thể nhập tệp mới nhất:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="importing.html#cb168-1" tabindex="-1"></a><span class="co"># import</span></span>
<span id="cb168-2"><a href="importing.html#cb168-2" tabindex="-1"></a><span class="fu">import</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;example&quot;</span>, <span class="st">&quot;linelists&quot;</span>, latest_file)) <span class="co"># import </span></span></code></pre></div>
</div>
<div id="sử-dụng-thông-tin-tệp" class="section level3 unnumbered">
<h3>Sử dụng thông tin tệp</h3>
<p>Nếu tệp của bạn không có ngày trong tên của chúng (hoặc bạn không tin tưởng vào những ngày đó), bạn có thể thử trích xuất ngày sửa đổi cuối cùng từ siêu dữ liệu tệp. Sử dụng các hàm từ package <strong>fs</strong> để kiểm tra thông tin siêu dữ liệu cho từng tệp, bao gồm thời gian sửa đổi cuối cùng và đường dẫn tệp.</p>
<p>Dưới đây, chúng tôi cung cấp thư mục quan tâm tới hàm <code>dir_info()</code> của package <strong>fs</strong>. Trong trường hợp này, thư mục quan tâm nằm trong dự án R trong thư mục “data”, thư mục con “example” và thư mục con thư mục này “linelists”. Kết quả là một data frame với một dòng cho mỗi tệp và các cột cho <code>modification_time</code>, <code>path</code>, v.v. Bạn có thể xem ví dụ trực quan về điều này trong chương về <a href="directories.html#directories">Tương tác với thư mục làm việc</a>.</p>
<p>Chúng ta có thể sắp xếp data frame này của các tệp theo cột với <code>modification_time</code>, và sau đó chỉ giữ lại hàng trên cùng/mới nhất (tệp) với <code>head()</code>của <strong>base</strong> R. Sau đó, chúng ta có thể trích xuất đường dẫn tệp của tệp mới nhất này chỉ với hàm <code>pull()</code> của <strong>dplyr</strong> trên <code>path</code> cột. Cuối cùng, chúng ta có thể chuyển đường dẫn tệp này đến <code>import()</code>. Tệp đã nhập được lưu dưới dạng <code>latest_file</code>.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="importing.html#cb169-1" tabindex="-1"></a>latest_file <span class="ot">&lt;-</span> <span class="fu">dir_info</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;example&quot;</span>, <span class="st">&quot;linelists&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># collect file info on all files in directory</span></span>
<span id="cb169-2"><a href="importing.html#cb169-2" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(modification_time)) <span class="sc">%&gt;%</span>      <span class="co"># sort by modification time</span></span>
<span id="cb169-3"><a href="importing.html#cb169-3" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span>                               <span class="co"># keep only the top (latest) file</span></span>
<span id="cb169-4"><a href="importing.html#cb169-4" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span>                            <span class="co"># extract only the file path</span></span>
<span id="cb169-5"><a href="importing.html#cb169-5" tabindex="-1"></a>  <span class="fu">import</span>()                                  <span class="co"># import the file</span></span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="import_api" class="section level2" number="7.10">
<h2><span class="header-section-number">7.10</span> API</h2>
<p>Một “Giao diện lập trình tự động (Automated Programming Interface)” (API) có thể được sử dụng để yêu cầu trực tiếp dữ liệu từ một trang web. API là một tập hợp các quy tắc cho phép một ứng dụng phần mềm tương tác với một ứng dụng phần mềm khác. Khách hàng (bạn) gửi một “yêu cầu (request)” và nhận được một “phản hồi (response)” có chứa nội dung. Các package R <strong>httr</strong> và <strong>jsonlite</strong> có thể hỗ trợ quá trình này.</p>
<p>Mỗi trang web hỗ trợ API sẽ có tài liệu và chi tiết cụ thể riêng để làm quen. Một số trang web công khai API và cho phép có thể được truy cập bởi bất kỳ ai. Những nền tảng khác, chẳng hạn như nền tảng có ID người dùng và thông tin đăng nhập, yêu cầu xác thực để truy cập dữ liệu của họ.</p>
<p>Không cần phải nói, để nhập dữ liệu qua API thì cần phải có kết nối internet. Chúng tôi sẽ đưa ra các ví dụ ngắn gọn về việc sử dụng API để nhập dữ liệu và liên kết bạn với các tài nguyên khác.</p>
<p><em>Lưu ý: Hãy nhớ lại rằng dữ liệu có thể được đăng trên một trang web không có API, điều này có thể dễ dàng truy xuất hơn. Ví dụ: một tệp CSV đã đăng có thể được truy cập chỉ bằng cách cung cấp URL của trang web để <code>import()</code> như được mô tả trong mục <a href="importing.html#import_github">nhập từ Github</a>.</em></p>
<div id="http-request" class="section level3 unnumbered">
<h3>HTTP request</h3>
<p>Trao đổi API thường được thực hiện thông qua một HTTP request. HTTP là Giao thức truyền siêu văn bản (Hypertext Transfer Protocol) và là định dạng cơ bản của giao thức yêu cầu (request)/phản hồi (response) giữa máy khách và máy chủ. Đầu vào và đầu ra chính xác có thể khác nhau tùy thuộc vào loại API nhưng quy trình là giống nhau - “Request” (thường là HTTP request) từ người dùng, thường chứa một truy vấn, theo sau là “Response”, chứa thông tin trạng thái về request và có thể là nội dung được yêu cầu.</p>
<p>Dưới đây là một số thành phần của một <em>HTTP request</em>:</p>
<ul>
<li>URL của điểm cuối API<br />
</li>
<li>“Method (Phương thức)” (hoặc “Verb (Động từ)”)<br />
</li>
<li>Các tiêu đề<br />
</li>
<li>Phần thân</li>
</ul>
<p>HTTP request “method” là hành động bạn muốn thực hiện. Hai phương thức HTTP phổ biến nhất là <code>GET</code> và <code>POST</code> nhưng những phương thức khác có thể bao gồm <code>PUT</code>, <code>DELETE</code>, <code>PATCH</code>, v.v. Khi nhập dữ liệu vào R, rất có thể bạn sẽ sử dụng <code>GET</code>.</p>
<p>Sau request của bạn, máy tính của bạn sẽ nhận được “phản hồi” ở định dạng tương tự như những gì bạn đã gửi, bao gồm URL, trạng thái HTTP (Trạng thái 200 là thứ bạn muốn!), loại tệp, kích thước và nội dung mong muốn. Sau đó, bạn sẽ cần phân tích cú pháp phản hồi này và biến nó thành một data frame khả thi trong môi trường R của bạn.</p>
</div>
<div id="package" class="section level3 unnumbered">
<h3>Package</h3>
<p>Package <strong>httr</strong> hoạt động tốt để xử lý các yêu cầu HTTP trong R. Nó đòi hỏi ít kiến thức về API Web và có thể được sử dụng bởi những người ít quen thuộc với thuật ngữ phát triển phần mềm. Ngoài ra, nếu phản hồi HTTP là .json, bạn có thể sử dụng <strong>jsonlite</strong> để phân tích cú pháp phản hồi.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="importing.html#cb170-1" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb170-2"><a href="importing.html#cb170-2" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(httr, jsonlite, tidyverse)</span></code></pre></div>
</div>
<div id="dữ-liệu-công-khai" class="section level3 unnumbered">
<h3>Dữ liệu công khai</h3>
<p>Dưới đây là một ví dụ về một HTTP request, được mượn từ một hướng dẫn từ <a href="https://www.trafforddatalab.io/open_data_companion/#A_quick_introduction_to_APIs">Phòng thí nghiệm Dữ liệu Trafford</a>. Trang web này chứa một số tài nguyên khác để tìm hiểu và các bài tập về API.</p>
<p>Tình huống: Chúng ta muốn nhập một danh sách các cửa hàng thức ăn nhanh ở thành phố Trafford, Vương quốc Anh. Dữ liệu có thể được truy cập từ API của Cơ quan Tiêu chuẩn Thực phẩm, cơ quan cung cấp dữ liệu xếp hạng vệ sinh thực phẩm cho Vương quốc Anh.</p>
<p>Dưới đây là các thông số cho yêu cầu của chúng tôi:</p>
<ul>
<li>Phương thức HTTP: GET<br />
</li>
<li>URL của điểm cuối API: <a href="http://api.ratings.food.gov.uk/Establishments" class="uri">http://api.ratings.food.gov.uk/Establishments</a><br />
</li>
<li>Các thông số đã chọn: tên, địa chỉ, kinh độ, vĩ độ, businessTypeId, ratingKey, localAuthorityId<br />
</li>
<li>Các tiêu đề: “x-api-version”, 2<br />
</li>
<li>(Các) Định dạng dữ liệu: JSON, XML<br />
</li>
<li>Tài liệu: <a href="http://api.ratings.food.gov.uk/help" class="uri">http://api.ratings.food.gov.uk/help</a></li>
</ul>
<p>R code sẽ như sau:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="importing.html#cb171-1" tabindex="-1"></a><span class="co"># prepare the request</span></span>
<span id="cb171-2"><a href="importing.html#cb171-2" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;http://api.ratings.food.gov.uk/Establishments&quot;</span></span>
<span id="cb171-3"><a href="importing.html#cb171-3" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">url =</span> path,</span>
<span id="cb171-4"><a href="importing.html#cb171-4" tabindex="-1"></a>             <span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb171-5"><a href="importing.html#cb171-5" tabindex="-1"></a>               <span class="at">localAuthorityId =</span> <span class="dv">188</span>,</span>
<span id="cb171-6"><a href="importing.html#cb171-6" tabindex="-1"></a>               <span class="at">BusinessTypeId =</span> <span class="dv">7844</span>,</span>
<span id="cb171-7"><a href="importing.html#cb171-7" tabindex="-1"></a>               <span class="at">pageNumber =</span> <span class="dv">1</span>,</span>
<span id="cb171-8"><a href="importing.html#cb171-8" tabindex="-1"></a>               <span class="at">pageSize =</span> <span class="dv">5000</span>),</span>
<span id="cb171-9"><a href="importing.html#cb171-9" tabindex="-1"></a>             <span class="fu">add_headers</span>(<span class="st">&quot;x-api-version&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>))</span>
<span id="cb171-10"><a href="importing.html#cb171-10" tabindex="-1"></a></span>
<span id="cb171-11"><a href="importing.html#cb171-11" tabindex="-1"></a><span class="co"># check for any server error (&quot;200&quot; is good!)</span></span>
<span id="cb171-12"><a href="importing.html#cb171-12" tabindex="-1"></a>request<span class="sc">$</span>status_code</span>
<span id="cb171-13"><a href="importing.html#cb171-13" tabindex="-1"></a></span>
<span id="cb171-14"><a href="importing.html#cb171-14" tabindex="-1"></a><span class="co"># submit the request, parse the response, and convert to a data frame</span></span>
<span id="cb171-15"><a href="importing.html#cb171-15" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">content</span>(request, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-16"><a href="importing.html#cb171-16" tabindex="-1"></a>  <span class="fu">fromJSON</span>(<span class="at">flatten =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-17"><a href="importing.html#cb171-17" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;establishments&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-18"><a href="importing.html#cb171-18" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<p>Bây giờ bạn có thể làm sạch và sử dụng data frame có tên <code>response</code>, với mỗi hàng là một cơ sở thức ăn nhanh.</p>
</div>
<div id="yêu-cầu-xác-thực" class="section level3 unnumbered">
<h3>Yêu cầu xác thực</h3>
<p>Một số API yêu cầu xác thực - để bạn chứng minh mình là ai và có thể truy cập vào dữ liệu bị hạn chế. Để nhập những dữ liệu này, trước tiên bạn có thể cần sử dụng phương thức POST để cung cấp tên người dùng, mật khẩu hoặc code. Điều này sẽ trả về một mã thông báo truy cập, có thể được sử dụng cho các yêu cầu phương thức GET tiếp theo để truy xuất dữ liệu mong muốn.</p>
<p>Dưới đây là một ví dụ về truy vấn dữ liệu từ <em>Go.Data</em>, một công cụ điều tra ổ dịch. <em>Go.Data</em> sử dụng một API cho tất cả các tương tác giữa giao diện người dùng web và các ứng dụng điện thoại thông minh được sử dụng để thu thập dữ liệu. <em>Go.Data</em> được sử dụng trên khắp thế giới. Bởi vì dữ liệu các vụ dịch là nhạy cảm và bạn nên là người duy nhất có thể truy cập vào dữ liệu vụ dịch <em>của mình</em>, nên việc xác thực là bắt buộc.</p>
<p>Dưới đây là một số code R mẫu sử dụng <strong>httr</strong> và <strong>jsonlite</strong> để kết nối với API <em>Go.Data</em> để nhập dữ liệu liên hệ truy vết từ vụ dịch của bạn.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="importing.html#cb172-1" tabindex="-1"></a><span class="co"># set credentials for authorization</span></span>
<span id="cb172-2"><a href="importing.html#cb172-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://godatasampleURL.int/&quot;</span>           <span class="co"># valid Go.Data instance url</span></span>
<span id="cb172-3"><a href="importing.html#cb172-3" tabindex="-1"></a>username <span class="ot">&lt;-</span> <span class="st">&quot;username&quot;</span>                          <span class="co"># valid Go.Data username </span></span>
<span id="cb172-4"><a href="importing.html#cb172-4" tabindex="-1"></a>password <span class="ot">&lt;-</span> <span class="st">&quot;password&quot;</span>                          <span class="co"># valid Go,Data password </span></span>
<span id="cb172-5"><a href="importing.html#cb172-5" tabindex="-1"></a>outbreak_id <span class="ot">&lt;-</span> <span class="st">&quot;xxxxxx-xxxx-xxxx-xxxx-xxxxxxx&quot;</span>  <span class="co"># valid Go.Data outbreak ID</span></span>
<span id="cb172-6"><a href="importing.html#cb172-6" tabindex="-1"></a></span>
<span id="cb172-7"><a href="importing.html#cb172-7" tabindex="-1"></a><span class="co"># get access token</span></span>
<span id="cb172-8"><a href="importing.html#cb172-8" tabindex="-1"></a>url_request <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url,<span class="st">&quot;api/oauth/token?access_token=123&quot;</span>) <span class="co"># define base URL request</span></span>
<span id="cb172-9"><a href="importing.html#cb172-9" tabindex="-1"></a></span>
<span id="cb172-10"><a href="importing.html#cb172-10" tabindex="-1"></a><span class="co"># prepare request</span></span>
<span id="cb172-11"><a href="importing.html#cb172-11" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">POST</span>(</span>
<span id="cb172-12"><a href="importing.html#cb172-12" tabindex="-1"></a>  <span class="at">url =</span> url_request,  </span>
<span id="cb172-13"><a href="importing.html#cb172-13" tabindex="-1"></a>  <span class="at">body =</span> <span class="fu">list</span>(</span>
<span id="cb172-14"><a href="importing.html#cb172-14" tabindex="-1"></a>    <span class="at">username =</span> username,    <span class="co"># use saved username/password from above to authorize                               </span></span>
<span id="cb172-15"><a href="importing.html#cb172-15" tabindex="-1"></a>    <span class="at">password =</span> password),                                       </span>
<span id="cb172-16"><a href="importing.html#cb172-16" tabindex="-1"></a>    <span class="at">encode =</span> <span class="st">&quot;json&quot;</span>)</span>
<span id="cb172-17"><a href="importing.html#cb172-17" tabindex="-1"></a></span>
<span id="cb172-18"><a href="importing.html#cb172-18" tabindex="-1"></a><span class="co"># execute request and parse response</span></span>
<span id="cb172-19"><a href="importing.html#cb172-19" tabindex="-1"></a>content <span class="ot">&lt;-</span></span>
<span id="cb172-20"><a href="importing.html#cb172-20" tabindex="-1"></a>  <span class="fu">content</span>(response, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb172-21"><a href="importing.html#cb172-21" tabindex="-1"></a>  <span class="fu">fromJSON</span>(<span class="at">flatten =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>          <span class="co"># flatten nested JSON</span></span>
<span id="cb172-22"><a href="importing.html#cb172-22" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb172-23"><a href="importing.html#cb172-23" tabindex="-1"></a></span>
<span id="cb172-24"><a href="importing.html#cb172-24" tabindex="-1"></a><span class="co"># Save access token from response</span></span>
<span id="cb172-25"><a href="importing.html#cb172-25" tabindex="-1"></a>access_token <span class="ot">&lt;-</span> content<span class="sc">$</span>access_token    <span class="co"># save access token to allow subsequent API calls below</span></span>
<span id="cb172-26"><a href="importing.html#cb172-26" tabindex="-1"></a></span>
<span id="cb172-27"><a href="importing.html#cb172-27" tabindex="-1"></a><span class="co"># import outbreak contacts</span></span>
<span id="cb172-28"><a href="importing.html#cb172-28" tabindex="-1"></a><span class="co"># Use the access token </span></span>
<span id="cb172-29"><a href="importing.html#cb172-29" tabindex="-1"></a>response_contacts <span class="ot">&lt;-</span> <span class="fu">GET</span>(</span>
<span id="cb172-30"><a href="importing.html#cb172-30" tabindex="-1"></a>  <span class="fu">paste0</span>(url,<span class="st">&quot;api/outbreaks/&quot;</span>,outbreak_id,<span class="st">&quot;/contacts&quot;</span>),          <span class="co"># GET request</span></span>
<span id="cb172-31"><a href="importing.html#cb172-31" tabindex="-1"></a>  <span class="fu">add_headers</span>(</span>
<span id="cb172-32"><a href="importing.html#cb172-32" tabindex="-1"></a>    <span class="at">Authorization =</span> <span class="fu">paste</span>(<span class="st">&quot;Bearer&quot;</span>, access_token, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)))</span>
<span id="cb172-33"><a href="importing.html#cb172-33" tabindex="-1"></a></span>
<span id="cb172-34"><a href="importing.html#cb172-34" tabindex="-1"></a>json_contacts <span class="ot">&lt;-</span> <span class="fu">content</span>(response_contacts, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>)         <span class="co"># convert to text JSON</span></span>
<span id="cb172-35"><a href="importing.html#cb172-35" tabindex="-1"></a></span>
<span id="cb172-36"><a href="importing.html#cb172-36" tabindex="-1"></a>contacts <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">fromJSON</span>(json_contacts, <span class="at">flatten =</span> <span class="cn">TRUE</span>))   <span class="co"># flatten JSON to tibble</span></span></code></pre></div>
<p><span style="color: orange;"><strong><em>CẨN TRỌNG:</em></strong> Nếu bạn đang nhập một lượng lớn dữ liệu từ một API yêu cầu xác thực, nó có thể hết thời gian chờ. Để tránh điều này, hãy truy xuất lại access_token trước mỗi yêu cầu API GET và thử sử dụng các bộ lọc hoặc giới hạn trong truy vấn.</span></p>
<p><span style="color: darkgreen;"><strong><em>MẸO:</em></strong> Lệnh <code>fromJSON()</code> từ package <strong>jsonlite</strong> không hoàn toàn không - lồng ghép vào lần đầu tiên nó được chạy, vì vậy bạn vẫn có thể có danh sách các hàng trong phần kết quả của mình. Bạn sẽ cần phải bỏ lồng ghép thêm cho một số biến nhất định; tùy thuộc vào cách .json của bạn được lồng ghép vào nhau. Để xem thêm thông tin về điều này, hãy xem tài liệu về package <strong>jsonlite</strong>, chẳng hạn như <a href="https://rdrr.io/cran/jsonlite/man/flatten.html"><code>flatten()</code> function</a>.</span></p>
<p>Để biết thêm chi tiết, hãy xem tài liệu trên <a href="https://loopback.io/doc/en/lb4/index.html">LoopBack Explorer</a>, chương <a href="data-used.html#truy-vết-tiếp-xúc">Truy vết tiếp xúc</a> hoặc các mẹo API trên <a href="https://worldhealthorganization.github.io/godata/api-docs">Go.Data Github repository</a></p>
<p>Bạn có thể đọc thêm về <em>httr</em> trong gói lệnh <a href="https://httr.r-lib.org/articles/quickstart.html">here</a></p>
<p>Phần này cũng đã được trình bày trong <a href="https://www.dataquest.io/blog/r-api-tutorial/">hướng dẫn này</a> và <a href="https://medium.com/@traffordDataLab/querying-apis-in-r-39029b73d5f1">hướng dẫn này</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="xuất-dữ-liệu" class="section level2" number="7.11">
<h2><span class="header-section-number">7.11</span> Xuất dữ liệu</h2>
<div id="với-package-rio" class="section level3 unnumbered">
<h3>Với package <strong>rio</strong></h3>
<p>Với <strong>rio</strong>, bạn có thể sử dụng lệnh <code>export()</code> theo cách tương tự với <code>import()</code>. Đầu tiên, cung cấp tên của đối tượng R bạn muốn lưu (ví dụ: <code>linelist</code>), sau đó trong dấu ngoặc kép đặt đường dẫn tệp nơi bạn muốn lưu tệp, bao gồm tên tệp mong muốn và phần mở rộng tệp. Ví dụ:</p>
<p>Thao tác này lưu data frame <code>linelist</code> dưới dạng một Excel workbook vào thư mục làm việc/thư mục gốc của dự án R:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="importing.html#cb173-1" tabindex="-1"></a><span class="fu">export</span>(linelist, <span class="st">&quot;my_linelist.xlsx&quot;</span>) <span class="co"># will save to working directory</span></span></code></pre></div>
<p>Bạn có thể lưu cùng một data frame dưới dạng tệp csv bằng cách thay đổi phần mở rộng. Ví dụ, chúng tôi cũng lưu nó vào một đường dẫn tệp được tạo bằng <code>here()</code>:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="importing.html#cb174-1" tabindex="-1"></a><span class="fu">export</span>(linelist, <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;clean&quot;</span>, <span class="st">&quot;my_linelist.csv&quot;</span>))</span></code></pre></div>
</div>
<div id="tới-clipboard" class="section level3 unnumbered">
<h3>Tới clipboard</h3>
<p>Để xuất khung dữ liệu sang “clipboard” của máy tính (để sau đó dán vào một phần mềm khác như Excel, Google Spreadsheets, v.v.), bạn có thể sử dụng <code>write_clip()</code> từ package <strong>clipr</strong>.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="importing.html#cb175-1" tabindex="-1"></a><span class="co"># export the linelist data frame to your system&#39;s clipboard</span></span>
<span id="cb175-2"><a href="importing.html#cb175-2" tabindex="-1"></a>clipr<span class="sc">::</span><span class="fu">write_clip</span>(linelist)</span></code></pre></div>
</div>
</div>
<div id="import_rds" class="section level2" number="7.12">
<h2><span class="header-section-number">7.12</span> Tệp RDS</h2>
<p>Giống như .csv, .xlsx, v.v., bạn cũng có thể xuất/lưu các R data frame dưới dạng tệp .rds. Đây là định dạng tệp dành riêng cho R và rất hữu ích nếu bạn biết mình sẽ làm việc lại với dữ liệu đã xuất trong R.</p>
<p>Các nhóm của cột được lưu trữ, vì vậy bạn không cần phải làm sạch lại khi chúng được nhập (với Excel hoặc thậm chí là tệp CSV, điều này có thể khiến bạn đau đầu!). Nó cũng là một tệp nhỏ hơn, hữu ích cho việc xuất và nhập nếu bộ dữ liệu của bạn lớn.</p>
<p>Ví dụ: nếu bạn làm việc trong nhóm Dịch tễ học và cần gửi tệp cho nhóm GIS để lập bản đồ và họ cũng sử dụng R, chỉ cần gửi tệp .rds cho họ! Sau đó, tất cả các nhóm cột được giữ lại và có ít việc phải xử lý hơn.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="importing.html#cb176-1" tabindex="-1"></a><span class="fu">export</span>(linelist, <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;clean&quot;</span>, <span class="st">&quot;my_linelist.rds&quot;</span>))</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="import_rdata" class="section level2" number="7.13">
<h2><span class="header-section-number">7.13</span> Tệp và danh sách Rdata</h2>
<p>Tệp <code>.Rdata</code> có thể lưu trữ nhiều đối tượng R - ví dụ: nhiều data frame, kết quả mô hình, danh sách, v.v. Điều này có thể rất hữu ích để hợp nhất hoặc chia sẻ nhiều dữ liệu của bạn cho một dự án nhất định.</p>
<p>Trong ví dụ dưới đây, nhiều đối tượng R được lưu trữ trong tệp “my_objects.Rdata” đã xuất:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="importing.html#cb177-1" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(my_list, my_dataframe, my_vector, <span class="st">&quot;my_objects.Rdata&quot;</span>)</span></code></pre></div>
<p>Lưu ý: nếu bạn đang thử <em>nhập</em> một danh sách, hãy sử dụng <code>import_list()</code> từ <strong>rio</strong> để nhập nó với cấu trúc và nội dung gốc hoàn chỉnh.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="importing.html#cb178-1" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">import_list</span>(<span class="st">&quot;my_list.Rdata&quot;</span>)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="lưu-biểu-đồ" class="section level2" number="7.14">
<h2><span class="header-section-number">7.14</span> Lưu biểu đồ</h2>
<p>Hướng dẫn về cách lưu các biểu đồ, chẳng hạn như các biểu đồ được tạo bởi <code>ggplot()</code>, được thảo luận sâu trong chương <a href="ggplot-basics.html#ggplot-basics">ggplot cơ bản</a>.</p>
<p>Tóm lại, chạy lệnh <code>ggsave("my_plot_filepath_and_name.png")</code> sau khi in biểu đồ của bạn. Bạn có thể cung cấp một đối tượng biểu đồ đã lưu cho đối số <code>plot =</code> hoặc chỉ cần xác định đường dẫn tệp đích (với phần mở rộng tệp) để lưu biểu đồ được hiển thị gần đây nhất. Bạn cũng có thể kiểm soát <code>width =</code>, <code>height =</code>, <code>units =</code> và <code>dpi =</code>.</p>
<p>Cách để lưu đồ thị mạng lưới (network graph), chẳng hạn như cây lây nhiễm, được đề cập trong chương <a href="transmission-chains.html#transmission-chains">Chuỗi lây nhiễm</a>.</p>
<!-- ======================================================= -->
</div>
<div id="tài-nguyên-học-liệu" class="section level2" number="7.15">
<h2><span class="header-section-number">7.15</span> Tài nguyên học liệu</h2>
<p><a href="https://cran.r-project.org/doc/manuals/r-release/R-data.html">R Data Import/Export Manual</a><br />
<a href="https://r4ds.had.co.nz/data-import.html#data-import">R 4 Data Science chapter on data import</a><br />
<a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave() documentation</a></p>
<p>Dưới đây là một bảng, lấy từ <strong>rio</strong> <a href="https://cran.r-project.org/web/packages/rio/vignettes/rio.html">vignette</a> trực tuyến. Đối với mỗi loại dữ liệu, nó hiển thị: phần mở rộng tệp dự kiến, package <strong>rio</strong> sử dụng để nhập hoặc xuất dữ liệu và trả lời chức năng này có được bao gồm trong phiên bản <strong>rio</strong> được cài đặt mặc định hay không.</p>
<table style="width:98%;">
<colgroup>
<col width="31%" />
<col width="18%" />
<col width="16%" />
<col width="10%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th>Định dạng</th>
<th>Phần mở rộng điển hình</th>
<th>Package nhập</th>
<th>Package xuất</th>
<th>Được cài đặt theo mặc định</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dữ liệu được phân tách bằng-dấu phẩy</td>
<td>.csv</td>
<td>data.table <code>fread()</code></td>
<td>data.table</td>
<td>Có</td>
</tr>
<tr class="even">
<td>Dữ liệu được phân tách bằng-dấu gạch</td>
<td>.psv</td>
<td>data.table <code>fread()</code></td>
<td>data.table</td>
<td>Có</td>
</tr>
<tr class="odd">
<td>Dữ liệu được phân tách bằng-tab</td>
<td>.tsv</td>
<td>data.table <code>fread()</code></td>
<td>data.table</td>
<td>Có</td>
</tr>
<tr class="even">
<td>SAS</td>
<td>.sas7bdat</td>
<td>haven</td>
<td>haven</td>
<td>Có</td>
</tr>
<tr class="odd">
<td>SPSS</td>
<td>.sav</td>
<td>haven</td>
<td>haven</td>
<td>Có</td>
</tr>
<tr class="even">
<td>Stata</td>
<td>.dta</td>
<td>haven</td>
<td>haven</td>
<td>Có</td>
</tr>
<tr class="odd">
<td>SAS</td>
<td>XPORT</td>
<td>.xpt</td>
<td>haven</td>
<td>haven</td>
</tr>
<tr class="even">
<td>SPSS Portable</td>
<td>.por</td>
<td>haven</td>
<td></td>
<td>Có</td>
</tr>
<tr class="odd">
<td>Excel</td>
<td>.xls</td>
<td>readxl</td>
<td></td>
<td>Có</td>
</tr>
<tr class="even">
<td>Excel</td>
<td>.xlsx</td>
<td>readxl</td>
<td>openxlsx</td>
<td>Có</td>
</tr>
<tr class="odd">
<td>Cú pháp R</td>
<td>.R</td>
<td>base</td>
<td>base</td>
<td>Có</td>
</tr>
<tr class="even">
<td>Đối tượng R được lưu</td>
<td>.RData, .rda</td>
<td>base</td>
<td>base</td>
<td>Có</td>
</tr>
<tr class="odd">
<td>Đối tượng R được nối tiếp</td>
<td>.rds</td>
<td>base</td>
<td>base</td>
<td>Có</td>
</tr>
<tr class="even">
<td>Epiinfo</td>
<td>.rec</td>
<td>foreign</td>
<td></td>
<td>Có</td>
</tr>
<tr class="odd">
<td>Minitab</td>
<td>.mtp</td>
<td>foreign</td>
<td></td>
<td>Có</td>
</tr>
<tr class="even">
<td>Systat</td>
<td>.syd</td>
<td>foreign</td>
<td></td>
<td>Có</td>
</tr>
<tr class="odd">
<td>“XBASE”</td>
<td>database files</td>
<td>.dbf</td>
<td>foreign</td>
<td>foreign</td>
</tr>
<tr class="even">
<td>Định dạng tệp Weka Attribute-Relation</td>
<td>.arff</td>
<td>foreign</td>
<td>foreign</td>
<td>Có</td>
</tr>
<tr class="odd">
<td>Định dạng trao đổi dữ liệu</td>
<td>.dif</td>
<td>utils</td>
<td></td>
<td>Có</td>
</tr>
<tr class="even">
<td>Dữ liệu Fortran</td>
<td>no recognized extension</td>
<td>utils</td>
<td></td>
<td>Có</td>
</tr>
<tr class="odd">
<td>Định dạng dữ liệu Fixed-width</td>
<td>.fwf</td>
<td>utils</td>
<td>utils</td>
<td>Có</td>
</tr>
<tr class="even">
<td>Dữ liệu gzip được phân tách bằng-dấu phẩy</td>
<td>.csv.gz</td>
<td>utils</td>
<td>utils</td>
<td>Có</td>
</tr>
<tr class="odd">
<td>CSVY (Tiêu đề siêu dữ liệu CSV + YAML)</td>
<td>.csvy</td>
<td>csvy</td>
<td>csvy</td>
<td>Không</td>
</tr>
<tr class="even">
<td>EViews</td>
<td>.wf1</td>
<td>hexView</td>
<td></td>
<td>Không</td>
</tr>
<tr class="odd">
<td>Định dạng trao đổi Feather giữa R/Python</td>
<td>.feather</td>
<td>feather</td>
<td>feather</td>
<td>Không</td>
</tr>
<tr class="even">
<td>Fast Storage</td>
<td>.fst</td>
<td>fst</td>
<td>fst</td>
<td>Không</td>
</tr>
<tr class="odd">
<td>JSON</td>
<td>.json</td>
<td>jsonlite</td>
<td>jsonlite</td>
<td>Không</td>
</tr>
<tr class="even">
<td>Matlab</td>
<td>.mat</td>
<td>rmatio</td>
<td>rmatio</td>
<td>Không</td>
</tr>
<tr class="odd">
<td>OpenDocument Spreadsheet</td>
<td>.ods</td>
<td>readODS</td>
<td>readODS</td>
<td>Không</td>
</tr>
<tr class="even">
<td>Bảng HTML</td>
<td>.html</td>
<td>xml2</td>
<td>xml2</td>
<td>Không</td>
</tr>
<tr class="odd">
<td>Tài liệu XML cạn</td>
<td>.xml</td>
<td>xml2</td>
<td>xml2</td>
<td>Không</td>
</tr>
<tr class="even">
<td>YAML</td>
<td>.yml</td>
<td>yaml</td>
<td>yaml</td>
<td>Không</td>
</tr>
<tr class="odd">
<td colspan="5">clipboard mặc định là tsv | | clipr | clipr | Không |</td>
</tr>
</tbody>
</table>

</div>
</div>



</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Cẩm nang dịch tễ học với R</strong>" was written by the handbook team. It was last built on 2024-02-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
