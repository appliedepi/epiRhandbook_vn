<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>21 Tỷ suất chuẩn hóa | Cẩm nang dịch tễ học với R</title>

    <meta name="author" content="the handbook team" />
  
   <meta name="description" content="The Epi R Handbook is a R reference manual for applied epidemiology and public health." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="21 Tỷ suất chuẩn hóa | Cẩm nang dịch tễ học với R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The Epi R Handbook is a R reference manual for applied epidemiology and public health." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="21 Tỷ suất chuẩn hóa | Cẩm nang dịch tễ học với R" />
  
  <meta name="twitter:description" content="The Epi R Handbook is a R reference manual for applied epidemiology and public health." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.6.1/transition.js"></script>
    <script src="libs/bs3compat-0.6.1/tabs.js"></script>
    <script src="libs/bs3compat-0.6.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.31/datatables.js"></script>
    <link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
    <link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
    <link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="libs/selectize-0.12.0/selectize.min.js"></script>
    <link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
    <script src="libs/tabwid-1.1.3/tabwid.js"></script>
    <link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-1.3.1/leaflet.js"></script>
    <link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4-2.6.2/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
    <script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
    <script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
    <script src="libs/viz-1.8.2/viz.js"></script>
    <link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding-1.0.11/grViz.js"></script>
    <script src="libs/d3-4.5.0/d3.min.js"></script>
    <script src="libs/sankey-1/sankey.js"></script>
    <script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
    <script src="libs/plotly-binding-4.10.4/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
    <link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
    <script src="libs/vis-9.1.0/vis-network.min.js"></script>
    <script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
    <link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script src="libs/plotly-basic-2.11.1/plotly-basic-2.11.1.min.js"></script>
    <script src="libs/plotly-cartesian-2.11.1/plotly-cartesian-2.11.1.min.js"></script>
    <script src="libs/proj4js-2.3.15/proj4.js"></script>
    <link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet" />
    <script src="libs/highcharts-9.3.1/highcharts.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-3d.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-more.js"></script>
    <script src="libs/highcharts-9.3.1/modules/stock.js"></script>
    <script src="libs/highcharts-9.3.1/modules/map.js"></script>
    <script src="libs/highcharts-9.3.1/modules/data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/drilldown.js"></script>
    <script src="libs/highcharts-9.3.1/modules/item-series.js"></script>
    <script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
    <script src="libs/highcharts-9.3.1/modules/annotations.js"></script>
    <script src="libs/highcharts-9.3.1/modules/export-data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/funnel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/heatmap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/treemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sankey.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/organization.js"></script>
    <script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
    <script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sunburst.js"></script>
    <script src="libs/highcharts-9.3.1/modules/vector.js"></script>
    <script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script>
    <script src="libs/highcharts-9.3.1/modules/xrange.js"></script>
    <script src="libs/highcharts-9.3.1/modules/tilemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/venn.js"></script>
    <script src="libs/highcharts-9.3.1/modules/gantt.js"></script>
    <script src="libs/highcharts-9.3.1/modules/timeline.js"></script>
    <script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
    <script src="libs/highcharts-9.3.1/modules/bullet.js"></script>
    <script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script>
    <script src="libs/highcharts-9.3.1/modules/lollipop.js"></script>
    <script src="libs/highcharts-9.3.1/modules/series-label.js"></script>
    <script src="libs/highcharts-9.3.1/plugins/motion.js"></script>
    <script src="libs/highcharts-9.3.1/custom/reset.js"></script>
    <script src="libs/highcharts-9.3.1/modules/boost.js"></script>
    <script src="libs/highchart-binding-0.9.4/highchart.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QXDW878QLX');
    </script>

    <div class="alert alert-info alert-dismissible">
      <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
      <strong>Bạn cần trợ giúp khi học R?</strong> Hãy tham gia <a href="https://www.appliedepi.org/live/" class="alert-link">khóa học</a>, trải nghiệm <a href="https://www.appliedepi.org/tutorial/" class="alert-link">các học phần miễn phí</a>, gửi bài viết <a href="https://community.appliedepi.org/" class="alert-link">trên trang Cộng đồng</a>, hoặc liên hệ <a href="mailto:contact@appliedepi.org" class="alert-link">dịch vụ hỗ trợ của chúng tôi</a>.
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style_bs4.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Cẩm nang dịch tễ học với R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="standardization" class="section level1" number="21">
<h1><span class="header-section-number">21</span> Tỷ suất chuẩn hóa</h1>
<p>Chương này sẽ hướng dẫn hai cách để chuẩn hóa một kết quả như là tỷ suất tử vong hoặc nhập viện theo các đặc điểm của tuổi và giới.</p>
<ul>
<li>Sử dụng package <strong>dsr</strong></li>
<li>Sử dụng package <strong>PHEindicatormethods</strong></li>
</ul>
<p>Chúng ta bắt đầu bằng cách làm rõ quá trình chuẩn bị/làm sạch/kết nối số liệu, vì việc này thường được thực hiện khi kết nối số liệu dân số từ nhiều quốc gia, số liệu dân số chuẩn, tử vong,.v.v.</p>
<div id="tổng-quan-1" class="section level2" number="21.1">
<h2><span class="header-section-number">21.1</span> Tổng quan</h2>
<p>Có hai cách để chuẩn hóa: trực tiếp và gián tiếp. Giả sử chúng ta muốn chuẩn hóa tỷ suất tử vong theo tuổi và giới của quốc gia A và quốc gia B, và so sánh tỷ suất chuẩn hóa giữa hai quốc gia này</p>
<ul>
<li>Đối với chuẩn hóa trực tiếp, chúng ta phải biết dân số nguy cơ và số tử vong theo từng tầng của tuổi và giới của quốc gia A và B. Một tầng trong ví dụ của chúng ta là phụ nữ trong nhóm tuổi từ 15-44.<br />
</li>
<li>Đối với chuẩn hóa gián tiếp, chúng ta chỉ cần biết tổng số tử vong và cấu trúc tuổi và giới của mỗi quốc gia. Vì thế, phương án này là khả khi tỷ suất tử vong hoặc dân số theo tuổi và giới không có sẵn. Hơn nữa, chuẩn hóa gián tiếp được ưa chuộng hơn khi có số lượng nhỏ trong các tầng, vì các ước tính trong chuẩn hóa trực tiếp sẽ bị ảnh hưởng bởi các thay đổi quan trọng khi lấy mẫu.</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="chuẩn-bị-11" class="section level2" number="21.2">
<h2><span class="header-section-number">21.2</span> Chuẩn bị</h2>
<p>Để chỉ dẫn cách thực hiện chuẩn hóa, chúng ta tạo ra dân số và số tử vong của quốc gia A và B theo tuổi (trong các nhóm tuổi của mỗi 5 tuổi) và giới (nữ, nam). Để các bộ số liệu có thể sử dụng được, chúng ta sẽ thực hiện các bước chuẩn bị như sau:</p>
<ol style="list-style-type: decimal">
<li>Gọi các packages<br />
</li>
<li>Tải các bộ số liệu<br />
</li>
<li>Nối số liệu dân số và tử vong của hai quốc gia</li>
<li>Xoay trục bộ số liệu dọc/dài hơn để có một hàng là một tầng theo tuổi-giới</li>
<li>Làm sạch quần thể tham chiếu (dân số thế giới chuẩn) và kết nối nó với số liệu của quốc gia</li>
</ol>
<p>Trong trường hợp này, số liệu của chúng ta có thể có các định dạng khác nhau. Có lẽ số liệu của chúng ta theo tỉnh, thành phố, hoặc khu vực dịch vụ khác. Chúng ta có thể có một hàng cho mỗi ca tử vong và các thông tin về tuổi và giới cho mỗi trường hợp (hoặc một tỷ lệ có ý nghĩa) của các ca tử vong này. Trong trường hợp này, hãy xem các chương về <a href="grouping.html#grouping">Nhóm dữ liệu</a>, <a href="pivoting.html#pivoting">Xoay trục dữ liệu</a>, và <a href="tables-descriptive.html#tables-descriptive">Bảng mô tả</a> để tạo một bộ số liệu với số lượng tử vong và dân số theo tầng của tuổi-giới tính.</p>
<p>Chúng ta cũng cần một quần thể tham chiếu, dân số chuẩn. Với mục đích của thực hành này, chúng ta sẽ sử dụng bộ số liệu <code>world_standard_population_by_sex</code>. Dân số chuẩn này dựa trên dân số của 46 quốc gia và được tạo ra vào năm 1960. Có rất nhiều dân số “chuẩn” – ví dụ, trang web của <a href="https://www.opendata.nhs.scot/dataset/standard-populations">NHS Scotland</a> cung cấp khá nhiều thông tin về Dân số Chuẩn của châu u, Dân số Chuẩn Thế giới, Dân số Chuẩn của Scotland.</p>
<!-- ======================================================= -->
<div id="gọi-packages-6" class="section level3 unnumbered">
<h3>Gọi packages</h3>
<p>Đoạn code này hiển thị việc gọi các package cần thiết cho các phân tích. Trong cuốn sách này, chúng tôi nhấn mạnh việc sử dụng hàm <code>p_load()</code> từ package <strong>pacman</strong>, giúp cài đặt các package cần thiết <em>và</em> gọi chúng ra để sử dụng. Bạn cũng có thể gọi các packages đã cài đặt với hàm <code>library()</code> của <strong>base</strong> R. Xem thêm chương <a href="basics.html#basics">R cơ bản</a> để có thêm thông tin về các packages trong R.</p>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1076-1"><a href="standardization.html#cb1076-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1076-2"><a href="standardization.html#cb1076-2" tabindex="-1"></a>     rio,                 <span class="co"># import/export data</span></span>
<span id="cb1076-3"><a href="standardization.html#cb1076-3" tabindex="-1"></a>     here,                <span class="co"># locate files</span></span>
<span id="cb1076-4"><a href="standardization.html#cb1076-4" tabindex="-1"></a>     tidyverse,           <span class="co"># data management and visualization</span></span>
<span id="cb1076-5"><a href="standardization.html#cb1076-5" tabindex="-1"></a>     stringr,             <span class="co"># cleaning characters and strings</span></span>
<span id="cb1076-6"><a href="standardization.html#cb1076-6" tabindex="-1"></a>     frailtypack,         <span class="co"># needed for dsr, for frailty models</span></span>
<span id="cb1076-7"><a href="standardization.html#cb1076-7" tabindex="-1"></a>     dsr,                 <span class="co"># standardise rates</span></span>
<span id="cb1076-8"><a href="standardization.html#cb1076-8" tabindex="-1"></a>     PHEindicatormethods) <span class="co"># alternative for rate standardisation</span></span></code></pre></div>
<p><span style="color: orange;"><strong><em>CẨN TRỌNG:</em></strong> Nếu đang sử dụng một phiên bản mới hơn của R, chúng ta không thể tải gói lệnh <strong>dsr</strong> trực tiếp từ CRAN. Tuy nhiên, nó vẫn còn trong mục lưu trữ của CRAN. Chúng ta có thể cài đặt và sử dụng nó. </span></p>
<p>Đối với người không sử dụng hệ điều hành Mac:</p>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1077-1"><a href="standardization.html#cb1077-1" tabindex="-1"></a>packageurl <span class="ot">&lt;-</span> <span class="st">&quot;https://cran.r-project.org/src/contrib/Archive/dsr/dsr_0.2.2.tar.gz&quot;</span></span>
<span id="cb1077-2"><a href="standardization.html#cb1077-2" tabindex="-1"></a><span class="fu">install.packages</span>(packageurl, <span class="at">repos=</span><span class="cn">NULL</span>, <span class="at">type=</span><span class="st">&quot;source&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="standardization.html#cb1078-1" tabindex="-1"></a><span class="co"># Other solution that may work</span></span>
<span id="cb1078-2"><a href="standardization.html#cb1078-2" tabindex="-1"></a><span class="fu">require</span>(devtools)</span>
<span id="cb1078-3"><a href="standardization.html#cb1078-3" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_version</span>(<span class="st">&quot;dsr&quot;</span>, <span class="at">version=</span><span class="st">&quot;0.2.2&quot;</span>, <span class="at">repos=</span><span class="st">&quot;http:/cran.us.r.project.org&quot;</span>)</span></code></pre></div>
<p>Đối với người sử dụng hệ điều hành Mac:</p>
<div class="sourceCode" id="cb1079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1079-1"><a href="standardization.html#cb1079-1" tabindex="-1"></a><span class="fu">require</span>(devtools)</span>
<span id="cb1079-2"><a href="standardization.html#cb1079-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_version</span>(<span class="st">&quot;dsr&quot;</span>, <span class="at">version=</span><span class="st">&quot;0.2.2&quot;</span>, <span class="at">repos=</span><span class="st">&quot;https://mac.R-project.org&quot;</span>)</span></code></pre></div>
</div>
<div id="tải-số-liệu-dân-số" class="section level3 unnumbered">
<h3>Tải số liệu dân số</h3>
<p>Xem chương <a href="data-used.html#data-used">Tải sách và dữ liệu</a> để biết các hướng dẫn về cách tải tất cả các bộ số liệu mẫu trong cuốn số tay này. Chúng ta có thể nhập trực tiếp dữ liệu trong chương Chuẩn hóa này tới R thông qua kho lưu trữ Github của chúng tôi bằng cách thực hiện lệnh sau <code>import()</code>:</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="standardization.html#cb1080-1" tabindex="-1"></a><span class="co"># import demographics for country A directly from Github</span></span>
<span id="cb1080-2"><a href="standardization.html#cb1080-2" tabindex="-1"></a>A_demo <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;https://github.com/appliedepi/epirhandbook_eng/raw/master/data/standardization/country_demographics.csv&quot;</span>)</span>
<span id="cb1080-3"><a href="standardization.html#cb1080-3" tabindex="-1"></a></span>
<span id="cb1080-4"><a href="standardization.html#cb1080-4" tabindex="-1"></a><span class="co"># import deaths for country A directly from Github</span></span>
<span id="cb1080-5"><a href="standardization.html#cb1080-5" tabindex="-1"></a>A_deaths <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;https://github.com/appliedepi/epirhandbook_eng/raw/master/data/standardization/deaths_countryA.csv&quot;</span>)</span>
<span id="cb1080-6"><a href="standardization.html#cb1080-6" tabindex="-1"></a></span>
<span id="cb1080-7"><a href="standardization.html#cb1080-7" tabindex="-1"></a><span class="co"># import demographics for country B directly from Github</span></span>
<span id="cb1080-8"><a href="standardization.html#cb1080-8" tabindex="-1"></a>B_demo <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;https://github.com/appliedepi/epirhandbook_eng/raw/master/data/standardization/country_demographics_2.csv&quot;</span>)</span>
<span id="cb1080-9"><a href="standardization.html#cb1080-9" tabindex="-1"></a></span>
<span id="cb1080-10"><a href="standardization.html#cb1080-10" tabindex="-1"></a><span class="co"># import deaths for country B directly from Github</span></span>
<span id="cb1080-11"><a href="standardization.html#cb1080-11" tabindex="-1"></a>B_deaths <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/standardization/deaths_countryB.csv&quot;</span>)</span>
<span id="cb1080-12"><a href="standardization.html#cb1080-12" tabindex="-1"></a></span>
<span id="cb1080-13"><a href="standardization.html#cb1080-13" tabindex="-1"></a><span class="co"># import demographics for country B directly from Github</span></span>
<span id="cb1080-14"><a href="standardization.html#cb1080-14" tabindex="-1"></a>standard_pop_data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/standardization/world_standard_population_by_sex.csv&quot;</span>)</span></code></pre></div>
<p>Trước tiên, chúng ta tải số liệu nhân khẩu (số lượng nam và nữ theo nhóm mỗi 5 tuổi) của hai quốc gia mà chúng ta sẽ so sánh, “Quốc gia A” và “Quốc gia B”.</p>
<div class="sourceCode" id="cb1081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1081-1"><a href="standardization.html#cb1081-1" tabindex="-1"></a><span class="co"># Country A</span></span>
<span id="cb1081-2"><a href="standardization.html#cb1081-2" tabindex="-1"></a>A_demo <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;country_demographics.csv&quot;</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-9dedb465c4552ef0ede7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9dedb465c4552ef0ede7">{"x":{"filter":"none","vertical":false,"data":[["A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A"],["0-4","5-9","10-14","15-19","20-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70-74","75-79","80-84","85"],[7828087,6705882,5601230,4576430,3734111,3111651,2571215,2121247,1735468,1418749,1145345,900239,685141,500248,347093,202240,94325,40402],[7674675,6592449,5522555,4533885,3726537,3118040,2592416,2150490,1771213,1459439,1193903,956070,745682,563894,416543,258538,130479,64656]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>age_cat5<\/th>\n      <th>m<\/th>\n      <th>f<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"name":"Country","targets":0},{"name":"age_cat5","targets":1},{"name":"m","targets":2},{"name":"f","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1082-1"><a href="standardization.html#cb1082-1" tabindex="-1"></a><span class="co"># Country B</span></span>
<span id="cb1082-2"><a href="standardization.html#cb1082-2" tabindex="-1"></a>B_demo <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;country_demographics_2.csv&quot;</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-5140ae7c7162acb24511" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5140ae7c7162acb24511">{"x":{"filter":"none","vertical":false,"data":[["B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],["0-4","5-9","10-14","15-19","20-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70-74","75-79","80-84","85"],[513458,508728,673522,844532,965423,1243552,1400065,1428773,1546221,1562880,2355220,2324555,2988200,2527110,1552200,1466902,876251,1073611],[503262,559249,652455,145453,965237,1238640,1392676,1505040,1671213,1459439,2218733,3528103,3204770,2500130,1683925,1683828,987362,1147563]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>age_cat5<\/th>\n      <th>m<\/th>\n      <th>f<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"name":"Country","targets":0},{"name":"age_cat5","targets":1},{"name":"m","targets":2},{"name":"f","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="tải-số-liệu-tử-vong" class="section level3 unnumbered">
<h3>Tải số liệu tử vong</h3>
<p>Để thuận tiện cho việc thực hành, chúng ta cũng có số lượng tử vong theo tuổi và giới trong khoảng thời gian quan tâm. Số lượng tử vong của mỗi quốc gia nằm trong một tập tin riêng, được hiện thị bên dưới.</p>
<p>Số tử vong ở Quốc gia A</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-d2bba81d783ae0401534" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d2bba81d783ae0401534">{"x":{"filter":"none","vertical":false,"data":[["A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A"],["0-4","5-9","10-14","15-19","20-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70-74","75-79","80-84","85"],[224,257,251,245,334,245,154,189,334,342,565,432,543,432,245,543,234,354],[194,254,232,214,316,224,163,167,354,354,463,574,493,295,175,380,177,392]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>AgeCat<\/th>\n      <th>Male<\/th>\n      <th>Female<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"name":"Country","targets":0},{"name":"AgeCat","targets":1},{"name":"Male","targets":2},{"name":"Female","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Số tử vong ở Quốc gia B</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-160b18b85dc4ac1ad3f0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-160b18b85dc4ac1ad3f0">{"x":{"filter":"none","vertical":false,"data":[["B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],["0-4","5-9","10-14","15-19","20-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70-74","75-79","80-84","85"],[34,37,51,145,434,120,100,143,307,354,463,639,706,232,275,543,234,274],[54,24,32,154,276,254,123,164,254,354,453,654,435,354,165,432,287,395]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>AgeCat<\/th>\n      <th>Male<\/th>\n      <th>Female<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"name":"Country","targets":0},{"name":"AgeCat","targets":1},{"name":"Male","targets":2},{"name":"Female","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="làm-sạch-số-liệu-dân-số-và-tử-vong" class="section level3 unnumbered">
<h3>Làm sạch số liệu dân số và tử vong</h3>
<p>Chúng ta cần kết nối và chuyển đổi các số liệu này theo những cách sau:</p>
<ul>
<li>Liên kết dân số của các quốc gia vào một bộ số liệu và xoay trục thành bộ số liệu dạng “dọc/dài” để mỗi tầng tuổi-giới là một hàng<br />
</li>
<li>Liên kết số liệu tử vong của các quốc gia vào một bộ số liệu và xoay trục thành bộ số liệu dạng “dọc/dài” để mỗi tầng tuổi-giới là một hàng<br />
</li>
<li>Nối số liệu tử vong với số liệu dân số</li>
</ul>
<p>Đầu tiên, chúng ta liên kết các bộ số liệu dân số quốc gia, chuyển đổi thành số liệu dạng dọc/dài hơn, và làm sạch số liệu. Xem chương <a href="pivoting.html#pivoting">Xoay trục dữ liệu</a> để biết thêm chi tiết.</p>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1083-1"><a href="standardization.html#cb1083-1" tabindex="-1"></a>pop_countries <span class="ot">&lt;-</span> A_demo <span class="sc">%&gt;%</span>  <span class="co"># begin with country A dataset</span></span>
<span id="cb1083-2"><a href="standardization.html#cb1083-2" tabindex="-1"></a>     <span class="fu">bind_rows</span>(B_demo) <span class="sc">%&gt;%</span>        <span class="co"># bind rows, because cols are identically named</span></span>
<span id="cb1083-3"><a href="standardization.html#cb1083-3" tabindex="-1"></a>     <span class="fu">pivot_longer</span>(                       <span class="co"># pivot longer</span></span>
<span id="cb1083-4"><a href="standardization.html#cb1083-4" tabindex="-1"></a>          <span class="at">cols =</span> <span class="fu">c</span>(m, f),                   <span class="co"># columns to combine into one</span></span>
<span id="cb1083-5"><a href="standardization.html#cb1083-5" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">&quot;Sex&quot;</span>,                 <span class="co"># name for new column containing the category (&quot;m&quot; or &quot;f&quot;) </span></span>
<span id="cb1083-6"><a href="standardization.html#cb1083-6" tabindex="-1"></a>          <span class="at">values_to =</span> <span class="st">&quot;Population&quot;</span>) <span class="sc">%&gt;%</span>     <span class="co"># name for new column containing the numeric values pivoted</span></span>
<span id="cb1083-7"><a href="standardization.html#cb1083-7" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">Sex =</span> <span class="fu">recode</span>(Sex,            <span class="co"># re-code values for clarity</span></span>
<span id="cb1083-8"><a href="standardization.html#cb1083-8" tabindex="-1"></a>          <span class="st">&quot;m&quot;</span> <span class="ot">=</span> <span class="st">&quot;Male&quot;</span>,</span>
<span id="cb1083-9"><a href="standardization.html#cb1083-9" tabindex="-1"></a>          <span class="st">&quot;f&quot;</span> <span class="ot">=</span> <span class="st">&quot;Female&quot;</span>))</span></code></pre></div>
<p>Số liệu dân số đã liên kết bây giờ trông giống như sau (nhấp qua để xem cột quốc gia A và B):</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e73e2a7c4c41c64f4583" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e73e2a7c4c41c64f4583">{"x":{"filter":"none","vertical":false,"data":[["A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],["0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85","0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85"],["Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female"],[7828087,7674675,6705882,6592449,5601230,5522555,4576430,4533885,3734111,3726537,3111651,3118040,2571215,2592416,2121247,2150490,1735468,1771213,1418749,1459439,1145345,1193903,900239,956070,685141,745682,500248,563894,347093,416543,202240,258538,94325,130479,40402,64656,513458,503262,508728,559249,673522,652455,844532,145453,965423,965237,1243552,1238640,1400065,1392676,1428773,1505040,1546221,1671213,1562880,1459439,2355220,2218733,2324555,3528103,2988200,3204770,2527110,2500130,1552200,1683925,1466902,1683828,876251,987362,1073611,1147563]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>age_cat5<\/th>\n      <th>Sex<\/th>\n      <th>Population<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":3},{"name":"Country","targets":0},{"name":"age_cat5","targets":1},{"name":"Sex","targets":2},{"name":"Population","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Và bây giờ, chúng ta thực hiện các thao tác tương tự trên hai bộ số liệu tử vong.</p>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1084-1"><a href="standardization.html#cb1084-1" tabindex="-1"></a>deaths_countries <span class="ot">&lt;-</span> A_deaths <span class="sc">%&gt;%</span>    <span class="co"># begin with country A deaths dataset</span></span>
<span id="cb1084-2"><a href="standardization.html#cb1084-2" tabindex="-1"></a>     <span class="fu">bind_rows</span>(B_deaths) <span class="sc">%&gt;%</span>        <span class="co"># bind rows with B dataset, because cols are identically named</span></span>
<span id="cb1084-3"><a href="standardization.html#cb1084-3" tabindex="-1"></a>     <span class="fu">pivot_longer</span>(                  <span class="co"># pivot longer</span></span>
<span id="cb1084-4"><a href="standardization.html#cb1084-4" tabindex="-1"></a>          <span class="at">cols =</span> <span class="fu">c</span>(Male, Female),        <span class="co"># column to transform into one</span></span>
<span id="cb1084-5"><a href="standardization.html#cb1084-5" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">&quot;Sex&quot;</span>,              <span class="co"># name for new column containing the category (&quot;m&quot; or &quot;f&quot;) </span></span>
<span id="cb1084-6"><a href="standardization.html#cb1084-6" tabindex="-1"></a>          <span class="at">values_to =</span> <span class="st">&quot;Deaths&quot;</span>) <span class="sc">%&gt;%</span>      <span class="co"># name for new column containing the numeric values pivoted</span></span>
<span id="cb1084-7"><a href="standardization.html#cb1084-7" tabindex="-1"></a>     <span class="fu">rename</span>(<span class="at">age_cat5 =</span> AgeCat)      <span class="co"># rename for clarity</span></span></code></pre></div>
<p>Số liệu tử vong bây giờ trông giống như sau và chứa số liệu của cả hai quốc gia:</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-efb9a08f4b13760194a3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-efb9a08f4b13760194a3">{"x":{"filter":"none","vertical":false,"data":[["A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],["0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85","0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85"],["Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female"],[224,194,257,254,251,232,245,214,334,316,245,224,154,163,189,167,334,354,342,354,565,463,432,574,543,493,432,295,245,175,543,380,234,177,354,392,34,54,37,24,51,32,145,154,434,276,120,254,100,123,143,164,307,254,354,354,463,453,639,654,706,435,232,354,275,165,543,432,234,287,274,395]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>age_cat5<\/th>\n      <th>Sex<\/th>\n      <th>Deaths<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":3},{"name":"Country","targets":0},{"name":"age_cat5","targets":1},{"name":"Sex","targets":2},{"name":"Deaths","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Bây giờ, chúng ta nối số liệu tử vong và số liệu dân số dựa trên các cột chung <code>Country</code>, <code>age_cat5</code>, và <code>Sex</code>. Thao tác này sẽ thêm cột <code>Deaths</code>.</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="standardization.html#cb1085-1" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> pop_countries <span class="sc">%&gt;%</span> </span>
<span id="cb1085-2"><a href="standardization.html#cb1085-2" tabindex="-1"></a>     <span class="fu">left_join</span>(deaths_countries, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;age_cat5&quot;</span>, <span class="st">&quot;Sex&quot;</span>))</span></code></pre></div>
<p>Bây giờ, chúng ta có thể phân loại các biến số <code>Sex</code>, <code>age_cat5</code>, và <code>Country</code> thành dạng factors và đặt thứ tự các giá trị của biến số bằng cách sử dụng hàm <code>fct_relevel()</code> từ package <strong>forcats</strong>, như được mô tả trong chương <a href="factors.html#factors">Factors</a>. Lưu ý rằng việc phân loại giá trị biến không thay đổi số liệu một cách rõ ràng, nhưng lệnh <code>arrange()</code> sẽ sắp xếp nó theo Quốc gia, nhóm tuổi và giới tính.</p>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1086-1"><a href="standardization.html#cb1086-1" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> country_data <span class="sc">%&gt;%</span> </span>
<span id="cb1086-2"><a href="standardization.html#cb1086-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1086-3"><a href="standardization.html#cb1086-3" tabindex="-1"></a>    <span class="at">Country =</span> <span class="fu">fct_relevel</span>(Country, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb1086-4"><a href="standardization.html#cb1086-4" tabindex="-1"></a>      </span>
<span id="cb1086-5"><a href="standardization.html#cb1086-5" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">fct_relevel</span>(Sex, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>),</span>
<span id="cb1086-6"><a href="standardization.html#cb1086-6" tabindex="-1"></a>        </span>
<span id="cb1086-7"><a href="standardization.html#cb1086-7" tabindex="-1"></a>    <span class="at">age_cat5 =</span> <span class="fu">fct_relevel</span>(</span>
<span id="cb1086-8"><a href="standardization.html#cb1086-8" tabindex="-1"></a>      age_cat5,</span>
<span id="cb1086-9"><a href="standardization.html#cb1086-9" tabindex="-1"></a>      <span class="st">&quot;0-4&quot;</span>, <span class="st">&quot;5-9&quot;</span>, <span class="st">&quot;10-14&quot;</span>, <span class="st">&quot;15-19&quot;</span>,</span>
<span id="cb1086-10"><a href="standardization.html#cb1086-10" tabindex="-1"></a>      <span class="st">&quot;20-24&quot;</span>, <span class="st">&quot;25-29&quot;</span>,  <span class="st">&quot;30-34&quot;</span>, <span class="st">&quot;35-39&quot;</span>,</span>
<span id="cb1086-11"><a href="standardization.html#cb1086-11" tabindex="-1"></a>      <span class="st">&quot;40-44&quot;</span>, <span class="st">&quot;45-49&quot;</span>, <span class="st">&quot;50-54&quot;</span>, <span class="st">&quot;55-59&quot;</span>,</span>
<span id="cb1086-12"><a href="standardization.html#cb1086-12" tabindex="-1"></a>      <span class="st">&quot;60-64&quot;</span>, <span class="st">&quot;65-69&quot;</span>, <span class="st">&quot;70-74&quot;</span>,</span>
<span id="cb1086-13"><a href="standardization.html#cb1086-13" tabindex="-1"></a>      <span class="st">&quot;75-79&quot;</span>, <span class="st">&quot;80-84&quot;</span>, <span class="st">&quot;85&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1086-14"><a href="standardization.html#cb1086-14" tabindex="-1"></a>          </span>
<span id="cb1086-15"><a href="standardization.html#cb1086-15" tabindex="-1"></a>  <span class="fu">arrange</span>(Country, age_cat5, Sex)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-934f129e60478008dddf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-934f129e60478008dddf">{"x":{"filter":"none","vertical":false,"data":[["A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],["0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85","0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85"],["Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female"],[7828087,7674675,6705882,6592449,5601230,5522555,4576430,4533885,3734111,3726537,3111651,3118040,2571215,2592416,2121247,2150490,1735468,1771213,1418749,1459439,1145345,1193903,900239,956070,685141,745682,500248,563894,347093,416543,202240,258538,94325,130479,40402,64656,513458,503262,508728,559249,673522,652455,844532,145453,965423,965237,1243552,1238640,1400065,1392676,1428773,1505040,1546221,1671213,1562880,1459439,2355220,2218733,2324555,3528103,2988200,3204770,2527110,2500130,1552200,1683925,1466902,1683828,876251,987362,1073611,1147563],[224,194,257,254,251,232,245,214,334,316,245,224,154,163,189,167,334,354,342,354,565,463,432,574,543,493,432,295,245,175,543,380,234,177,354,392,34,54,37,24,51,32,145,154,434,276,120,254,100,123,143,164,307,254,354,354,463,453,639,654,706,435,232,354,275,165,543,432,234,287,274,395]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>age_cat5<\/th>\n      <th>Sex<\/th>\n      <th>Population<\/th>\n      <th>Deaths<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4]},{"name":"Country","targets":0},{"name":"age_cat5","targets":1},{"name":"Sex","targets":2},{"name":"Population","targets":3},{"name":"Deaths","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p><span style="color: orange;"><strong><em>CẨN TRỌNG:</em></strong> Nếu số trường hợp tử vong mỗi tầng là nhỏ, hãy cân nhắc chia nhóm tuổi mỗi 10-15 năm thay vì mỗi 5 năm cho các nhóm.</span></p>
</div>
<div id="tải-dân-số-tham-chiếu" class="section level3 unnumbered">
<h3>Tải dân số tham chiếu</h3>
<p>Cuối cùng, để chuẩn hóa trực tiếp, chúng ta nhập dân số tham chiếu (“dân số chuẩn” thế giới theo giới tính)</p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="standardization.html#cb1087-1" tabindex="-1"></a><span class="co"># Reference population</span></span>
<span id="cb1087-2"><a href="standardization.html#cb1087-2" tabindex="-1"></a>standard_pop_data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;world_standard_population_by_sex.csv&quot;</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-3f33296e48694cd888af" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3f33296e48694cd888af">{"x":{"filter":"none","vertical":false,"data":[["0-4 years","0-4 years","5-9 years","5-9 years","10-14 years","10-14 years","15-19 years","15-19 years","20-24 years","20-24 years","25-29 years","25-29 years","30-34 years","30-34 years","35-39 years","35-39 years","40-44 years","40-44 years","45-49 years","45-49 years","50-54 years","50-54 years","55-59 years","55-59 years","60-64 years","60-64 years","65-69 years","65-69 years","70-74 years","70-74 years","75-79 years","75-79 years","80-84 years","80-84 years","85plus years","85plus years"],["Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female"],[12000,12000,10000,10000,9000,9000,9000,9000,8000,8000,8000,8000,6000,6000,6000,6000,6000,6000,6000,6000,5000,5000,4000,4000,4000,4000,3000,3000,2000,2000,1000,1000,500,500,500,500]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>age_cat5<\/th>\n      <th>Sex<\/th>\n      <th>WorldStandardPopulation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2},{"name":"age_cat5","targets":0},{"name":"Sex","targets":1},{"name":"WorldStandardPopulation","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<!-- ======================================================= -->
</div>
<div id="làm-sach-dân-số-tham-chiếu" class="section level3 unnumbered">
<h3>Làm sach dân số tham chiếu</h3>
<p>Các giá trị của biến tuổi trong bộ số liệu <code>country_data</code> và <code>standard_pop_data</code> cần phải được căn chỉnh.</p>
<p>Hiện tại, các giá trị của cột biến phân loại <code>age_cat5</code> trong bộ số liệu <code>standard_pop_data</code> có chứa từ “years” và “plus”, trong khi không có các từ này trong trong bộ số liệu <code>country_data</code>. Chúng ta cần phải chuyển đổi các giá trị này giống nhau. Chúng ta sẽ sử dụng hàm <code>str_replace_all()</code> từ package <strong>stringr</strong>, như được mô tả trong chương <a href="characters-strings.html#characters-strings">Ký tự và chuỗi</a>, để thay thế thành những kiểu mẫu không có khoảng trắng <code>""</code>.</p>
<p>Hơn nữa, package <strong>dsr</strong> đòi hỏi cột chứa số lượng trong bộ số liệu dân số chuẩn phải được gọi là <code>"pop"</code>. Vì vậy, chúng ta đổi tên cột này cho phù hợp.</p>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1088-1"><a href="standardization.html#cb1088-1" tabindex="-1"></a><span class="co"># Remove specific string from column values</span></span>
<span id="cb1088-2"><a href="standardization.html#cb1088-2" tabindex="-1"></a>standard_pop_clean <span class="ot">&lt;-</span> standard_pop_data <span class="sc">%&gt;%</span></span>
<span id="cb1088-3"><a href="standardization.html#cb1088-3" tabindex="-1"></a>     <span class="fu">mutate</span>(</span>
<span id="cb1088-4"><a href="standardization.html#cb1088-4" tabindex="-1"></a>          <span class="at">age_cat5 =</span> <span class="fu">str_replace_all</span>(age_cat5, <span class="st">&quot;years&quot;</span>, <span class="st">&quot;&quot;</span>),   <span class="co"># remove &quot;year&quot;</span></span>
<span id="cb1088-5"><a href="standardization.html#cb1088-5" tabindex="-1"></a>          <span class="at">age_cat5 =</span> <span class="fu">str_replace_all</span>(age_cat5, <span class="st">&quot;plus&quot;</span>, <span class="st">&quot;&quot;</span>),    <span class="co"># remove &quot;plus&quot;</span></span>
<span id="cb1088-6"><a href="standardization.html#cb1088-6" tabindex="-1"></a>          <span class="at">age_cat5 =</span> <span class="fu">str_replace_all</span>(age_cat5, <span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span>   <span class="co"># remove &quot; &quot; space</span></span>
<span id="cb1088-7"><a href="standardization.html#cb1088-7" tabindex="-1"></a>     </span>
<span id="cb1088-8"><a href="standardization.html#cb1088-8" tabindex="-1"></a>     <span class="fu">rename</span>(<span class="at">pop =</span> WorldStandardPopulation)   <span class="co"># change col name to &quot;pop&quot;, as this is expected by dsr package</span></span></code></pre></div>
<p><span style="color: orange;"><strong><em>CẨN TRỌNG:</em></strong> Nếu chúng ta cố gắng sử dụng hàm <code>str_replace_all()</code> để loại bỏ <em>biểu tượng</em> dấu cộng, hàm này sẽ không thực hiện bởi vì nó là một biểu tượng đặc biệt. “Xử lý” các biểu tượng này bằng cách đặt hai dấu gạch chéo phía trước như trong lệnh <code>str_replace_call(column, "\\+", "")</code>. </span></p>
</div>
<div id="standard_all" class="section level3 unnumbered">
<h3>Tạo bộ số liệu với dân số chuẩn</h3>
<p>Cuối cùng, sử dụng package <strong>PHEindicatormethods</strong>, được trình bày chi tiết <a href="standardization.html#standard_phe">bên dưới</a>, để nối dân số chuẩn vào biến tử vong và dân số của các quốc gia. Vì vậy, chúng ta sẽ tạo một bộ số liệu với tên <code>all_data</code> cho mục đích đó.</p>
<div class="sourceCode" id="cb1089"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1089-1"><a href="standardization.html#cb1089-1" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(country_data, standard_pop_clean, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;age_cat5&quot;</span>, <span class="st">&quot;Sex&quot;</span>))</span></code></pre></div>
<p>Bộ số liệu hoàn chỉnh trông sẽ như thế này:</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-6d49d5f88fbbac109679" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6d49d5f88fbbac109679">{"x":{"filter":"none","vertical":false,"data":[["A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B","B"],["0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85","0-4","0-4","5-9","5-9","10-14","10-14","15-19","15-19","20-24","20-24","25-29","25-29","30-34","30-34","35-39","35-39","40-44","40-44","45-49","45-49","50-54","50-54","55-59","55-59","60-64","60-64","65-69","65-69","70-74","70-74","75-79","75-79","80-84","80-84","85","85"],["Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female"],[7828087,7674675,6705882,6592449,5601230,5522555,4576430,4533885,3734111,3726537,3111651,3118040,2571215,2592416,2121247,2150490,1735468,1771213,1418749,1459439,1145345,1193903,900239,956070,685141,745682,500248,563894,347093,416543,202240,258538,94325,130479,40402,64656,513458,503262,508728,559249,673522,652455,844532,145453,965423,965237,1243552,1238640,1400065,1392676,1428773,1505040,1546221,1671213,1562880,1459439,2355220,2218733,2324555,3528103,2988200,3204770,2527110,2500130,1552200,1683925,1466902,1683828,876251,987362,1073611,1147563],[224,194,257,254,251,232,245,214,334,316,245,224,154,163,189,167,334,354,342,354,565,463,432,574,543,493,432,295,245,175,543,380,234,177,354,392,34,54,37,24,51,32,145,154,434,276,120,254,100,123,143,164,307,254,354,354,463,453,639,654,706,435,232,354,275,165,543,432,234,287,274,395],[12000,12000,10000,10000,9000,9000,9000,9000,8000,8000,8000,8000,6000,6000,6000,6000,6000,6000,6000,6000,5000,5000,4000,4000,4000,4000,3000,3000,2000,2000,1000,1000,500,500,500,500,12000,12000,10000,10000,9000,9000,9000,9000,8000,8000,8000,8000,6000,6000,6000,6000,6000,6000,6000,6000,5000,5000,4000,4000,4000,4000,3000,3000,2000,2000,1000,1000,500,500,500,500]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Country<\/th>\n      <th>age_cat5<\/th>\n      <th>Sex<\/th>\n      <th>Population<\/th>\n      <th>Deaths<\/th>\n      <th>pop<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"name":"Country","targets":0},{"name":"age_cat5","targets":1},{"name":"Sex","targets":2},{"name":"Population","targets":3},{"name":"Deaths","targets":4},{"name":"pop","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<!-- ======================================================= -->
</div>
</div>
<div id="package-dsr" class="section level2" number="21.3">
<h2><span class="header-section-number">21.3</span> Package <strong>dsr</strong></h2>
<p>Bên dưới, chúng tôi trình bày việc tính toán và so sánh các tỷ suất được chuẩn hóa trực tiếp bằng cách sử dụng package <strong>dsr</strong>. Package <strong>dsr</strong> cho phép chúng ta tính toán và so sánh các tỷ suất được chuẩn hóa trực tiếp (không phải các tỷ suất được chuẩn hóa gián tiếp!).</p>
<p>Trong phần Chuẩn bị số liệu, chúng ta đã tạo các bộ số liệu riêng biệt cho các quốc gia và dân số chuẩn:</p>
<ol style="list-style-type: decimal">
<li>đối tượng <code>country_data</code> mà là một bảng dân số với số lượng dân số và số tử vong theo tầng cho mỗi quốc gia<br />
</li>
<li>đối tượng <code>standard_pop_clean</code>, bao gồm số lượng dân số theo tầng cho dân số tham chiếu, Dân số Chuẩn Thế giới</li>
</ol>
<p>Chúng ta sẽ sử dụng các bộ số liệu riêng rẽ này cho cách tiếp cận sử dụng package <strong>dsr</strong>.</p>
<!-- ======================================================= -->
<div id="tỷ-suất-chuẩn-hóa" class="section level3 unnumbered">
<h3>Tỷ suất chuẩn hóa</h3>
<p>Bên dưới, chúng ta tính toán các tỷ suất theo quốc gia được chuẩn hóa trực tiếp theo tuổi và giới. Chúng ta sử dụng hàm <code>dsr()</code>.</p>
<p>Lưu ý - <code>dsr()</code> đòi hỏi một bộ số liệu dân số của các quốc gia và số lượng sự kiện (tử vong), <em>và một bộ số liệu</em> <strong>riêng rẽ</strong> <em>với dân số tham chiếu</em>. Nó cũng đòi hỏi trong bộ số liệu của dân số tham chiếu này tên cột đơn vị-thời gian là “pop” (chúng ta đã đảm bảo điều này trong phần Chuẩn bị số liệu).</p>
<p>Có nhiều đối số, như được chú thích bên dưới. Đáng chú ý, đối số <code>event =</code> được đặt thành cột <code>Deaths</code>, và đối số <code>fu =</code> (“follow-up”) được đặt thành cột <code>Population</code>. Chúng ta đặt các nhóm so sánh là cột <code>Country</code> và chuẩn hóa dựa trên cột <code>age_cat5</code> và <code>Sex</code>. Hai cột cuối cùng này không được gán với một đối số có tên cụ thể. Gõ <code>?dsr</code> để biết thêm chi tiết.</p>
<div class="sourceCode" id="cb1090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1090-1"><a href="standardization.html#cb1090-1" tabindex="-1"></a><span class="co"># Calculate rates per country directly standardized for age and sex</span></span>
<span id="cb1090-2"><a href="standardization.html#cb1090-2" tabindex="-1"></a>mortality_rate <span class="ot">&lt;-</span> dsr<span class="sc">::</span><span class="fu">dsr</span>(</span>
<span id="cb1090-3"><a href="standardization.html#cb1090-3" tabindex="-1"></a>     <span class="at">data =</span> country_data,  <span class="co"># specify object containing number of deaths per stratum</span></span>
<span id="cb1090-4"><a href="standardization.html#cb1090-4" tabindex="-1"></a>     <span class="at">event =</span> Deaths,       <span class="co"># column containing number of deaths per stratum </span></span>
<span id="cb1090-5"><a href="standardization.html#cb1090-5" tabindex="-1"></a>     <span class="at">fu =</span> Population,      <span class="co"># column containing number of population per stratum</span></span>
<span id="cb1090-6"><a href="standardization.html#cb1090-6" tabindex="-1"></a>     <span class="at">subgroup =</span> Country,   <span class="co"># units we would like to compare</span></span>
<span id="cb1090-7"><a href="standardization.html#cb1090-7" tabindex="-1"></a>     age_cat5,             <span class="co"># other columns - rates will be standardized by these</span></span>
<span id="cb1090-8"><a href="standardization.html#cb1090-8" tabindex="-1"></a>     Sex,</span>
<span id="cb1090-9"><a href="standardization.html#cb1090-9" tabindex="-1"></a>     <span class="at">refdata =</span> standard_pop_clean, <span class="co"># reference population data frame, with column called pop</span></span>
<span id="cb1090-10"><a href="standardization.html#cb1090-10" tabindex="-1"></a>     <span class="at">method =</span> <span class="st">&quot;gamma&quot;</span>,      <span class="co"># method to calculate 95% CI</span></span>
<span id="cb1090-11"><a href="standardization.html#cb1090-11" tabindex="-1"></a>     <span class="at">sig =</span> <span class="fl">0.95</span>,            <span class="co"># significance level</span></span>
<span id="cb1090-12"><a href="standardization.html#cb1090-12" tabindex="-1"></a>     <span class="at">mp =</span> <span class="dv">100000</span>,           <span class="co"># we want rates per 100.000 population</span></span>
<span id="cb1090-13"><a href="standardization.html#cb1090-13" tabindex="-1"></a>     <span class="at">decimals =</span> <span class="dv">2</span>)          <span class="co"># number of decimals)</span></span>
<span id="cb1090-14"><a href="standardization.html#cb1090-14" tabindex="-1"></a></span>
<span id="cb1090-15"><a href="standardization.html#cb1090-15" tabindex="-1"></a></span>
<span id="cb1090-16"><a href="standardization.html#cb1090-16" tabindex="-1"></a><span class="co"># Print output as nice-looking HTML table</span></span>
<span id="cb1090-17"><a href="standardization.html#cb1090-17" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mortality_rate) <span class="co"># show mortality rate before and after direct standardization</span></span></code></pre></div>
<table>
<colgroup>
<col width="6%" />
<col width="7%" />
<col width="8%" />
<col width="17%" />
<col width="11%" />
<col width="11%" />
<col width="16%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Subgroup</th>
<th align="right">Numerator</th>
<th align="right">Denominator</th>
<th align="right">Crude Rate (per 100000)</th>
<th align="right">95% LCL (Crude)</th>
<th align="right">95% UCL (Crude)</th>
<th align="right">Std Rate (per 100000)</th>
<th align="right">95% LCL (Std)</th>
<th align="right">95% UCL (Std)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">11344</td>
<td align="right">86790567</td>
<td align="right">13.07</td>
<td align="right">12.83</td>
<td align="right">13.31</td>
<td align="right">23.57</td>
<td align="right">23.08</td>
<td align="right">24.06</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">9955</td>
<td align="right">52898281</td>
<td align="right">18.82</td>
<td align="right">18.45</td>
<td align="right">19.19</td>
<td align="right">19.33</td>
<td align="right">18.46</td>
<td align="right">20.22</td>
</tr>
</tbody>
</table>
<p>Bên trên, chúng ta thấy rằng tỷ suất tử vong thô của quốc gia A thấp hơn quốc gia B, nhưng tỷ suất được chuẩn hóa trực tiếp theo tuổi và giới thì cao hơn.</p>
<!-- ======================================================= -->
</div>
<div id="tỷ-số-của-các-tỷ-suất-chuẩn-hóa" class="section level3 unnumbered">
<h3>Tỷ số của các tỷ suất chuẩn hóa</h3>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1091-1"><a href="standardization.html#cb1091-1" tabindex="-1"></a><span class="co"># Calculate RR</span></span>
<span id="cb1091-2"><a href="standardization.html#cb1091-2" tabindex="-1"></a>mortality_rr <span class="ot">&lt;-</span> dsr<span class="sc">::</span><span class="fu">dsrr</span>(</span>
<span id="cb1091-3"><a href="standardization.html#cb1091-3" tabindex="-1"></a>     <span class="at">data =</span> country_data, <span class="co"># specify object containing number of deaths per stratum</span></span>
<span id="cb1091-4"><a href="standardization.html#cb1091-4" tabindex="-1"></a>     <span class="at">event =</span> Deaths,      <span class="co"># column containing number of deaths per stratum </span></span>
<span id="cb1091-5"><a href="standardization.html#cb1091-5" tabindex="-1"></a>     <span class="at">fu =</span> Population,     <span class="co"># column containing number of population per stratum</span></span>
<span id="cb1091-6"><a href="standardization.html#cb1091-6" tabindex="-1"></a>     <span class="at">subgroup =</span> Country,  <span class="co"># units we would like to compare</span></span>
<span id="cb1091-7"><a href="standardization.html#cb1091-7" tabindex="-1"></a>     age_cat5,</span>
<span id="cb1091-8"><a href="standardization.html#cb1091-8" tabindex="-1"></a>     Sex,                 <span class="co"># characteristics to which we would like to standardize </span></span>
<span id="cb1091-9"><a href="standardization.html#cb1091-9" tabindex="-1"></a>     <span class="at">refdata =</span> standard_pop_clean, <span class="co"># reference population, with numbers in column called pop</span></span>
<span id="cb1091-10"><a href="standardization.html#cb1091-10" tabindex="-1"></a>     <span class="at">refgroup =</span> <span class="st">&quot;B&quot;</span>,      <span class="co"># reference for comparison</span></span>
<span id="cb1091-11"><a href="standardization.html#cb1091-11" tabindex="-1"></a>     <span class="at">estimate =</span> <span class="st">&quot;ratio&quot;</span>,  <span class="co"># type of estimate</span></span>
<span id="cb1091-12"><a href="standardization.html#cb1091-12" tabindex="-1"></a>     <span class="at">sig =</span> <span class="fl">0.95</span>,          <span class="co"># significance level</span></span>
<span id="cb1091-13"><a href="standardization.html#cb1091-13" tabindex="-1"></a>     <span class="at">mp =</span> <span class="dv">100000</span>,         <span class="co"># we want rates per 100.000 population</span></span>
<span id="cb1091-14"><a href="standardization.html#cb1091-14" tabindex="-1"></a>     <span class="at">decimals =</span> <span class="dv">2</span>)        <span class="co"># number of decimals</span></span>
<span id="cb1091-15"><a href="standardization.html#cb1091-15" tabindex="-1"></a></span>
<span id="cb1091-16"><a href="standardization.html#cb1091-16" tabindex="-1"></a><span class="co"># Print table</span></span>
<span id="cb1091-17"><a href="standardization.html#cb1091-17" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mortality_rr) </span></code></pre></div>
<table>
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="25%" />
<col width="18%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Comparator</th>
<th align="left">Reference</th>
<th align="right">Std Rate (per 100000)</th>
<th align="right">Rate Ratio (RR)</th>
<th align="right">95% LCL (RR)</th>
<th align="right">95% UCL (RR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">B</td>
<td align="right">23.57</td>
<td align="right">1.22</td>
<td align="right">1.17</td>
<td align="right">1.27</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">B</td>
<td align="right">19.33</td>
<td align="right">1.00</td>
<td align="right">0.94</td>
<td align="right">1.06</td>
</tr>
</tbody>
</table>
<p>Tỷ suất tử vong chuẩn hóa của quốc gia A cao gấp 1.22 lần so với quốc gia B (95% CI 1.17-1.27).</p>
<!-- ======================================================= -->
</div>
<div id="khác-biệt-của-các-tỷ-suất-chuẩn-hóa" class="section level3 unnumbered">
<h3>Khác biệt của các tỷ suất chuẩn hóa</h3>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1092-1"><a href="standardization.html#cb1092-1" tabindex="-1"></a><span class="co"># Calculate RD</span></span>
<span id="cb1092-2"><a href="standardization.html#cb1092-2" tabindex="-1"></a>mortality_rd <span class="ot">&lt;-</span> dsr<span class="sc">::</span><span class="fu">dsrr</span>(</span>
<span id="cb1092-3"><a href="standardization.html#cb1092-3" tabindex="-1"></a>     <span class="at">data =</span> country_data,       <span class="co"># specify object containing number of deaths per stratum</span></span>
<span id="cb1092-4"><a href="standardization.html#cb1092-4" tabindex="-1"></a>     <span class="at">event =</span> Deaths,            <span class="co"># column containing number of deaths per stratum </span></span>
<span id="cb1092-5"><a href="standardization.html#cb1092-5" tabindex="-1"></a>     <span class="at">fu =</span> Population,           <span class="co"># column containing number of population per stratum</span></span>
<span id="cb1092-6"><a href="standardization.html#cb1092-6" tabindex="-1"></a>     <span class="at">subgroup =</span> Country,        <span class="co"># units we would like to compare</span></span>
<span id="cb1092-7"><a href="standardization.html#cb1092-7" tabindex="-1"></a>     age_cat5,                  <span class="co"># characteristics to which we would like to standardize</span></span>
<span id="cb1092-8"><a href="standardization.html#cb1092-8" tabindex="-1"></a>     Sex,                        </span>
<span id="cb1092-9"><a href="standardization.html#cb1092-9" tabindex="-1"></a>     <span class="at">refdata =</span> standard_pop_clean, <span class="co"># reference population, with numbers in column called pop</span></span>
<span id="cb1092-10"><a href="standardization.html#cb1092-10" tabindex="-1"></a>     <span class="at">refgroup =</span> <span class="st">&quot;B&quot;</span>,            <span class="co"># reference for comparison</span></span>
<span id="cb1092-11"><a href="standardization.html#cb1092-11" tabindex="-1"></a>     <span class="at">estimate =</span> <span class="st">&quot;difference&quot;</span>,   <span class="co"># type of estimate</span></span>
<span id="cb1092-12"><a href="standardization.html#cb1092-12" tabindex="-1"></a>     <span class="at">sig =</span> <span class="fl">0.95</span>,                <span class="co"># significance level</span></span>
<span id="cb1092-13"><a href="standardization.html#cb1092-13" tabindex="-1"></a>     <span class="at">mp =</span> <span class="dv">100000</span>,               <span class="co"># we want rates per 100.000 population</span></span>
<span id="cb1092-14"><a href="standardization.html#cb1092-14" tabindex="-1"></a>     <span class="at">decimals =</span> <span class="dv">2</span>)              <span class="co"># number of decimals</span></span>
<span id="cb1092-15"><a href="standardization.html#cb1092-15" tabindex="-1"></a></span>
<span id="cb1092-16"><a href="standardization.html#cb1092-16" tabindex="-1"></a><span class="co"># Print table</span></span>
<span id="cb1092-17"><a href="standardization.html#cb1092-17" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mortality_rd) </span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="24%" />
<col width="23%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Comparator</th>
<th align="left">Reference</th>
<th align="right">Std Rate (per 100000)</th>
<th align="right">Rate Difference (RD)</th>
<th align="right">95% LCL (RD)</th>
<th align="right">95% UCL (RD)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">B</td>
<td align="right">23.57</td>
<td align="right">4.24</td>
<td align="right">3.24</td>
<td align="right">5.24</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">B</td>
<td align="right">19.33</td>
<td align="right">0.00</td>
<td align="right">-1.24</td>
<td align="right">1.24</td>
</tr>
</tbody>
</table>
<p>Quốc gia A có hơn 4,24 ca tử vong trên 100,000 dân (95% CI 3.24-5.24) so với quốc gia B.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="standard_phe" class="section level2" number="21.4">
<h2><span class="header-section-number">21.4</span> Package <strong>PHEindicatormethods</strong></h2>
<p>Một cách khác để tính tỷ suất chuẩn hóa là dùng package <strong>PHEindicatormethods</strong>. Package này cho phép chúng ta tính toán tỷ suất chuẩn hóa trực tiếp cũng như gián tiếp. Chúng tôi sẽ hướng dẫn cả hai.</p>
<p>Phần này chúng ta sẽ sử dụng bộ số liệu <code>all_data</code> được tạo ở cuối phần Chuẩn bị. Bộ số liệu này bao gồm dân số quốc gia, số tử vong và dân số tham chiếu. Bạn có thể xem nó ở <a href="standardization.html#standard_all">đây</a>.</p>
<!-- ======================================================= -->
<div id="tỷ-suất-chuẩn-hóa-trực-tiếp" class="section level3 unnumbered">
<h3>Tỷ suất chuẩn hóa trực tiếp</h3>
<p>Đầu tiên, chúng ta nhóm số liệu theo Quốc gia như bên dưới và sau đó chuyển số liệu vào hàm <code>phe_dsr()</code> để có được tỷ suất chuẩn hóa trực tiếp theo quốc gia.</p>
<p>Lưu ý, dân số tham chiếu (chuẩn) có thể được cung cấp dưới dạng một <strong>cột bên trong số liệu của một quốc gia cụ thể</strong> hoặc dưới dạng một <strong>véctơ riêng biệt</strong>. Nếu được cung cấp bên trong số liệu của một quốc gia cụ thể, bạn phải đặt <code>stdpoptype = "field"</code>. Nếu được cung cấp như một véc tơ, đặt <code>stdpoptype = "vector"</code>. Trong trường hợp thứ hai, chúng ta phải đảm bảo thứ tự của các hàng theo tầng tương tự nhau trong cả khung số liệu quốc gia và dân số tham chiếu, vì vị trí các bản ghi/các hàng phải khớp với nhau. Trong ví dụ bên dưới, chúng tôi đã cung cấp dân số tham chiếu dưới dạng một cột bên trong khung số liệu của một quốc gia cụ thể.</p>
<p>Xem trợ giúp bằng cách gõ <code>?phr_dsr</code> hoặc các liên kết trong phần Tài nguyên học liệu để biết thêm thông tin.</p>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1093-1"><a href="standardization.html#cb1093-1" tabindex="-1"></a><span class="co"># Calculate rates per country directly standardized for age and sex</span></span>
<span id="cb1093-2"><a href="standardization.html#cb1093-2" tabindex="-1"></a>mortality_ds_rate_phe <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb1093-3"><a href="standardization.html#cb1093-3" tabindex="-1"></a>     <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb1093-4"><a href="standardization.html#cb1093-4" tabindex="-1"></a>     PHEindicatormethods<span class="sc">::</span><span class="fu">phe_dsr</span>(</span>
<span id="cb1093-5"><a href="standardization.html#cb1093-5" tabindex="-1"></a>          <span class="at">x =</span> Deaths,                 <span class="co"># column with observed number of events</span></span>
<span id="cb1093-6"><a href="standardization.html#cb1093-6" tabindex="-1"></a>          <span class="at">n =</span> Population,             <span class="co"># column with non-standard pops for each stratum</span></span>
<span id="cb1093-7"><a href="standardization.html#cb1093-7" tabindex="-1"></a>          <span class="at">stdpop =</span> pop,               <span class="co"># standard populations for each stratum</span></span>
<span id="cb1093-8"><a href="standardization.html#cb1093-8" tabindex="-1"></a>          <span class="at">stdpoptype =</span> <span class="st">&quot;field&quot;</span>)       <span class="co"># either &quot;vector&quot; for a standalone vector or &quot;field&quot; meaning std populations are in the data  </span></span>
<span id="cb1093-9"><a href="standardization.html#cb1093-9" tabindex="-1"></a></span>
<span id="cb1093-10"><a href="standardization.html#cb1093-10" tabindex="-1"></a><span class="co"># Print table</span></span>
<span id="cb1093-11"><a href="standardization.html#cb1093-11" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mortality_ds_rate_phe)</span></code></pre></div>
<table>
<colgroup>
<col width="8%" />
<col width="13%" />
<col width="11%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="12%" />
<col width="16%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">total_count</th>
<th align="right">total_pop</th>
<th align="right">value</th>
<th align="right">lowercl</th>
<th align="right">uppercl</th>
<th align="left">confidence</th>
<th align="left">statistic</th>
<th align="left">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">11344</td>
<td align="right">86790567</td>
<td align="right">23.56686</td>
<td align="right">23.08107</td>
<td align="right">24.05944</td>
<td align="left">95%</td>
<td align="left">dsr per 100000</td>
<td align="left">Dobson</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">9955</td>
<td align="right">52898281</td>
<td align="right">19.32549</td>
<td align="right">18.45516</td>
<td align="right">20.20882</td>
<td align="left">95%</td>
<td align="left">dsr per 100000</td>
<td align="left">Dobson</td>
</tr>
</tbody>
</table>
<!-- ======================================================= -->
</div>
<div id="standard_indirect" class="section level3 unnumbered">
<h3>Tỷ suất chuẩn hóa gián tiếp</h3>
<p>Để chuẩn hóa gián tiếp, chúng ta cần dân số tham chiếu có số lượng tử vong và dân số theo tầng. Trong ví dụ này, chúng ta sẽ tính tỷ suất của quốc gia A bằng cách <em>sử dụng quốc gia B làm dân số tham chiếu</em>, vì dân số tham chiếu trong bộ số liệu <code>standard_pop_clean</code> không có số lượng tử vong theo tầng.</p>
<p>Trước tiên, chúng ta tạo dân số tham chiếu từ quốc gia B như bên dưới. Sau đó, chúng ta chuyển số liệu tử vong và dân số của quốc gia A, kết nối nó với dân số tham chiếu và chuyển nó vào hàm <code>calculate_ISRate()</code>, để có được tỷ suất chuẩn hóa gián tiếp. Dĩ nhiên, chúng ta cũng có thể làm ngược lại.</p>
<p>Lưu ý - trong ví dụ bên dưới, dân số tham chiếu được cung cấp dưới dạng một data frame riêng rẽ. Trong trường hợp này, chúng ta cần đảm bảo rằng các véctơ <code>x =</code>, <code>n =</code>, <code>x_ref =</code> và <code>n_ref =</code> tất cả được sắp đặt cùng giá trị với loại chuẩn hóa (theo đúng tầng) như được sắp đặt trong data frame quốc gia, vì vị trí các bản ghi/các hàng phải khớp với nhau.</p>
<p>Xem trợ giúp bằng cách gõ <code>?phr_isr</code> hoặc các liên kết trong phần Tài nguyên học liệu để biết thêm thông tin.</p>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1094-1"><a href="standardization.html#cb1094-1" tabindex="-1"></a><span class="co"># Create reference population</span></span>
<span id="cb1094-2"><a href="standardization.html#cb1094-2" tabindex="-1"></a>refpopCountryB <span class="ot">&lt;-</span> country_data <span class="sc">%&gt;%</span> </span>
<span id="cb1094-3"><a href="standardization.html#cb1094-3" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;B&quot;</span>) </span>
<span id="cb1094-4"><a href="standardization.html#cb1094-4" tabindex="-1"></a></span>
<span id="cb1094-5"><a href="standardization.html#cb1094-5" tabindex="-1"></a><span class="co"># Calculate rates for country A indirectly standardized by age and sex</span></span>
<span id="cb1094-6"><a href="standardization.html#cb1094-6" tabindex="-1"></a>mortality_is_rate_phe_A <span class="ot">&lt;-</span> country_data <span class="sc">%&gt;%</span></span>
<span id="cb1094-7"><a href="standardization.html#cb1094-7" tabindex="-1"></a>     <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;A&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1094-8"><a href="standardization.html#cb1094-8" tabindex="-1"></a>     PHEindicatormethods<span class="sc">::</span><span class="fu">calculate_ISRate</span>(</span>
<span id="cb1094-9"><a href="standardization.html#cb1094-9" tabindex="-1"></a>          <span class="at">x =</span> Deaths,                 <span class="co"># column with observed number of events</span></span>
<span id="cb1094-10"><a href="standardization.html#cb1094-10" tabindex="-1"></a>          <span class="at">n =</span> Population,             <span class="co"># column with non-standard pops for each stratum</span></span>
<span id="cb1094-11"><a href="standardization.html#cb1094-11" tabindex="-1"></a>          <span class="at">x_ref =</span> refpopCountryB<span class="sc">$</span>Deaths,  <span class="co"># reference number of deaths for each stratum</span></span>
<span id="cb1094-12"><a href="standardization.html#cb1094-12" tabindex="-1"></a>          <span class="at">n_ref =</span> refpopCountryB<span class="sc">$</span>Population)  <span class="co"># reference population for each stratum</span></span>
<span id="cb1094-13"><a href="standardization.html#cb1094-13" tabindex="-1"></a></span>
<span id="cb1094-14"><a href="standardization.html#cb1094-14" tabindex="-1"></a><span class="co"># Print table</span></span>
<span id="cb1094-15"><a href="standardization.html#cb1094-15" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mortality_is_rate_phe_A)</span></code></pre></div>
<table>
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="35%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">observed</th>
<th align="right">expected</th>
<th align="right">ref_rate</th>
<th align="right">value</th>
<th align="right">lowercl</th>
<th align="right">uppercl</th>
<th align="left">confidence</th>
<th align="left">statistic</th>
<th align="left">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">11344</td>
<td align="right">15847.42</td>
<td align="right">18.81914</td>
<td align="right">13.47123</td>
<td align="right">13.22446</td>
<td align="right">13.72145</td>
<td align="left">95%</td>
<td align="left">indirectly standardised rate per 100000</td>
<td align="left">Byars</td>
</tr>
</tbody>
</table>
<!-- ======================================================= -->
</div>
</div>
<div id="tài-nguyên-học-liệu-6" class="section level2" number="21.5">
<h2><span class="header-section-number">21.5</span> Tài nguyên học liệu</h2>
<p>Nếu bạn muốn tìm thêm các ví dụ có thể tái lập được sử dụng package <strong>dsr</strong>, vui lòng xem <a href="https://mran.microsoft.com/snapshot/2020-02-12/web/packages/dsr/vignettes/dsr.html">hướng dẫn này</a></p>
<p>Với các ví dụ khác sử dụng package <strong>PHEindicatormethods</strong>, vui lòng xem tại <a href="https://mran.microsoft.com/snapshot/2018-10-22/web/packages/PHEindicatormethods/vignettes/IntroductiontoPHEindicatormethods.html">website này</a></p>
<p>Xem thêm <strong>PHEindicatormethods</strong> <a href="https://cran.r-project.org/web/packages/PHEindicatormethods/PHEindicatormethods.pdf">tài liệu dưới dạng tệp pdf</a></p>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Cẩm nang dịch tễ học với R</strong>" was written by the handbook team. It was last built on 2024-02-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
